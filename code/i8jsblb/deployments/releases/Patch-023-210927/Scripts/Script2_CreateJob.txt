----------Job to delete the entries from the table BILL_STATUS after 15 minutes------
----Please change the schema 'I8_MICROBANK_JS_DEV' according to environment QA/Staging/Production----


BEGIN
    DBMS_SCHEDULER.CREATE_JOB (
            job_name => '"I8_MICROBANK_JS_DEV"."CLEAN_BILL_STATUS_JOB"',
            job_type => 'PLSQL_BLOCK',
            job_action => 'DELETE FROM BILL_STATUS WHERE CREATED_ON < SYSTIMESTAMP - INTERVAL ''15'' minute; commit;',
            number_of_arguments => 0,
            start_date => systimestamp,
            repeat_interval => 'FREQ=MINUTELY;INTERVAL=15',
            end_date =>null,
            enabled => FALSE,
            auto_drop => FALSE,
            comments => 'Removes Data from bill status after 15 minutes');

         
     
 
    DBMS_SCHEDULER.SET_ATTRIBUTE( 
             name => '"I8_MICROBANK_JS_DEV"."CLEAN_BILL_STATUS_JOB"', 
             attribute => 'logging_level', value => DBMS_SCHEDULER.LOGGING_OFF);
      
  
    
    DBMS_SCHEDULER.enable(
             name => '"I8_MICROBANK_JS_DEV"."CLEAN_BILL_STATUS_JOB"');
END;