CREATE OR REPLACE FORCE VIEW "I8_MICROBANK_JS_DEV"."RETRY_ADVICE_LIST_SUMMARY_VIEW" ("MIDDLEWARE_RETRY_ADV_RPRT_ID", "TRANSACTION_CODE_ID", "TRANSACTION_CODE", "PRODUCT_ID", "PRODUCT_NAME", "INTG_TRANSACTION_TYPE_ID", "FROM_ACCOUNT", "TO_ACCOUNT", "TRANSACTION_AMOUNT", "TRANSMISSION_TIME", "REQUEST_TIME", "STAN", "REVERSAL_STAN", "REVERSAL_REQUEST_TIME", "RESPONSE_CODE", "STATUS", "CREATED_ON", "UPDATED_ON", "ADVICE_TYPE", "CUSTOMER_MOBILE_NO","CNIC") AS 
  SELECT MRAR.MIDDLEWARE_RETRY_ADV_RPRT_ID,
          MRAR.TRANSACTION_CODE AS TRANSACTION_CODE_ID,
          MRAR.TRANSACTION_CODE,
          MRAR.PRODUCT_ID,
          P.NAME AS PRODUCT_NAME,
          MRAR.INTG_TRANSACTION_TYPE_ID,
          MRAR.FROM_ACCOUNT,
          MRAR.TO_ACCOUNT,
          MRAR.TRANSACTION_AMOUNT,
          MRAR.TRANSMISSION_TIME,
          MRAR.REQUEST_TIME,
          MRAR.STAN,
          MRAR.REVERSAL_STAN,
          MRAR.REVERSAL_REQUEST_TIME,
          MRAR.RESPONSE_CODE,
          MRAR.STATUS,
          MRAR.CREATED_ON,
          MRAR.UPDATED_ON,
          MRAR.ADVICE_TYPE,
          MRAR.CONSUMER_NUMBER,
          MRAR.CNIC
     FROM MIDDLEWARE_RETRY_ADVICE_REPORT MRAR, PRODUCT P
    WHERE NVL(MRAR.PRODUCT_ID,0) = P.PRODUCT_ID(+)    
          AND MRAR.MIDDLEWARE_RETRY_ADV_RPRT_ID =
                 (SELECT MAX (MIDDLEWARE_RETRY_ADV_RPRT_ID)
                    FROM MIDDLEWARE_RETRY_ADVICE_REPORT
                   WHERE (TRANSACTION_CODE = MRAR.TRANSACTION_CODE OR STAN=MRAR.STAN));