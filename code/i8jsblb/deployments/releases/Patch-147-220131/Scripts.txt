  CREATE OR REPLACE FORCE VIEW "DEBIT_CARD_EXPORT_DATA_VIEW" ("DEBIT_CARD_ID", "MOBILE_NO", "RELATIONSHIP_NUMBER", "CUSTOMER_TYPE_CODE", "BRANCH_CODE", "SEGMENT_CODE", "CUSTOMER_STATUS_CODE", "CUSTOMER_NAME", "GENDER_CODE", "ACCOUNT_NUMBER", "ACCOUNT_TITLE", "ACCOUNT_STATUS_CODE", "CURRENCY_CODE", "CARD_EMBOSING_NAME", "CARD_TYPE_CODE", "CARD_PRODUCT_CODE", "ACCOUNT_TYPE_CODE", "REQUEST_TYPE", "CREATED_BY", "CREATED_ON", "UPDATED_BY", "UPDATED_ON", "NIC_EXPIRY", "MOTHER_MAIDEN_NAME", "DOB", "BIRTH_PLACE", "FATHER_HUSBAND_NAME", "DEBIT_CARD_MAILING_ADDRESS", "CITY", "COUNTRY_CODE", IBAN) AS 
  SELECT DC.DEBIT_CARD_ID,
          DC.MOBILE_NO,
          DC.CNIC,
          AC.CUSTOMER_ACCOUNT_TYPE_ID,
          '002',
          C.SEGMENT_ID,
          SMA.STATUS_ID,
          APP.FIRST_NAME || ' ' || APP.LAST_NAME,
          C.GENDER,
          AC.ACCOUNT_NUMBER,
          AH.FIRST_NAME || ' ' || AH.LAST_NAME,
          AC.STATUS_ID,
          '586',
          DC.EMBOSING_NAME,
          nvl(CARD_TYPE_CODE,'002') CARD_TYPE_CODE,
          NVL (CARD_PRODUCT_CODE, '002') CARD_PRODUCT_CODE,
          1,
          SMA.ACCOUNT_TYPE_ID,
          CREATEDBY.USERNAME,
          DC.CREATED_ON,
          UPDATEDBY.USERNAME,
          DC.UPDATED_ON,
          APP.NIC_EXPIRY_DATE,
          APP.MOTHER_MAIDEN_NAME,
          APP.DOB,
          C.BIRTH_PLACE,
          C.FATHER_HUSBAND_NAME,
          DCMA.ADDRESS,
          CA.CITY,
          C1.COUNTRY_CODE,
          C.IBAN
     FROM DEBIT_CARD DC
          INNER JOIN APP_USER APP
             ON     APP.MOBILE_NO = DC.MOBILE_NO
                AND APP.NIC = DC.CNIC
                AND APP.APP_USER_ID = DC.APP_USER_ID
          INNER JOIN USER_DEVICE_ACCOUNTS UDA
             ON UDA.APP_USER_ID = APP.APP_USER_ID
          INNER JOIN APP_USER CREATEDBY
             ON CREATEDBY.APP_USER_ID = DC.CREATED_BY
          INNER JOIN APP_USER UPDATEDBY
             ON UPDATEDBY.APP_USER_ID = DC.UPDATED_BY
          INNER JOIN CUSTOMER C
             ON C.CUSTOMER_ID = APP.CUSTOMER_ID
          INNER JOIN CARD_STATUS STATUS
             ON STATUS.CARD_STATUS_ID = DC.CARD_STATUS_ID
          INNER JOIN SEGMENT SEG
             ON SEG.SEGMENT_ID = C.SEGMENT_ID
          INNER JOIN ACCOUNT_HOLDER AH
             ON AH.MOBILE_NUMBER = DC.MOBILE_NO AND AH.CNIC = DC.CNIC
          INNER JOIN ACCOUNT AC
             ON AC.ACCOUNT_HOLDER_ID = AH.ACCOUNT_HOLDER_ID
          INNER JOIN OLA_CUSTOMER_ACCOUNT_TYPE OLA
             ON OLA.CUSTOMER_ACCOUNT_TYPE_ID = AC.CUSTOMER_ACCOUNT_TYPE_ID
          INNER JOIN OLA_STATUS ACSTATUS
             ON ACSTATUS.STATUS_ID = AC.STATUS_ID
          INNER JOIN SMART_MONEY_ACCOUNT SMA
             ON SMA.SMART_MONEY_ACCOUNT_ID = DC.SMART_MONEY_ACCOUNT_ID
          LEFT JOIN OLA_STATUS SMASTATUS
             ON SMASTATUS.STATUS_ID = SMA.STATUS_ID
          INNER JOIN DEBIT_CARD_MAILING_ADDRESS DCMA
             ON DCMA.DEBIT_CARD_MAILING_ADDRESS_ID = DC.MAILING_ADDRESS_ID
          LEFT JOIN CUSTOMER_ADDRESS_VIEW CA
             ON CA.CUSTOMER_ID = C.CUSTOMER_ID
          INNER JOIN COUNTRY C1
             ON C1.COUNTRY_ID = APP.COUNTRY_ID
          LEFT JOIN CARD_PRODUCT_TYPE
             ON SMA.CARD_PRODUCT_TYPE_ID =
                   CARD_PRODUCT_TYPE.CARD_PRODUCT_TYPE_ID
    WHERE     DC.CARD_STATUS_ID = 4
          AND AC.CUSTOMER_ACCOUNT_TYPE_ID <> 9
          AND AC.CUSTOMER_ACCOUNT_TYPE_ID IN (1, 2);

