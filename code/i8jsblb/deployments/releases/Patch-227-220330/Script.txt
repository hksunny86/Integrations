CREATE OR REPLACE FORCE VIEW "LEVEL3_ACCOUNTS_VIEW" ("APP_USER_ID", "RETAILER_CONTACT_ID", "RETAILER_ID", "INITIAL_APP_FORM_NUMBER", "CNIC", "MOBILE_NO", "DORMANCY_REMOVED_ON", "CREATED_ON", "USER_ID", "ACCOUNT_TYPE_ID", "ACCOUNT_TYPE_NAME", "REGISTRATION_STATE_ID", "REGISTRATION_STATE_NAME") AS 
  SELECT au.APP_USER_ID,
    rc.RETAILER_CONTACT_ID,
    rc.RETAILER_ID,
    rc.INITIAL_APP_FORM_NUMBER,
    au.NIC AS CNIC,
    au.MOBILE_NO,
    au.DORMANCY_REMOVED_ON,
    au.CREATED_ON,
    uda.USER_ID,
    rc.ACCOUNT_TYPE_ID,
    olaat.NAME AS ACCOUNT_TYPE_NAME,
    au.REGISTRATION_STATE_ID,
    rs.name AS REGISTRATION_STATE_NAME
  FROM APP_USER au,
    USER_DEVICE_ACCOUNTS uda,
    RETAILER_CONTACT rc,
    OLA_CUSTOMER_ACCOUNT_TYPE olaat,
    REGISTRATION_STATE rs
  WHERE au.APP_USER_ID         =uda.APP_USER_ID
  AND au.RETAILER_CONTACT_ID   =rc.RETAILER_CONTACT_ID
  AND rc.ACCOUNT_TYPE_ID       =olaat.CUSTOMER_ACCOUNT_TYPE_ID
  AND au.REGISTRATION_STATE_ID = rs.REGISTRATION_STATE_ID
  AND au.app_user_type_id      =3
  AND uda.device_type_id       =5;

