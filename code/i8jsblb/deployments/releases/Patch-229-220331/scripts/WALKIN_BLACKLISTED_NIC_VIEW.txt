
  CREATE OR REPLACE FORCE VIEW "WALKIN_BLACKLISTED_NIC_VIEW" ("PK", "CNIC_NO", "ACTION", "ACTION_DATE", "ACTION_PERFORMED_BY", "COMMENTS") AS 
  SELECT a.blklst_mark_unmark_hist_id PK,
CNIC_NO,
       ACTION,
       A.UPDATED_ON ACTION_DATE,
       USERNAME ACTION_PERFORMED_BY,
       COMMENTS
  FROM BLACKLIST_MARK_UNMARK_HISTORY A, APP_USER B
WHERE     A.UPDATED_BY = B.APP_USER_ID
       AND EXISTS
              (SELECT 1
                 FROM APP_USER C
                WHERE C.NIC = A.CNIC_NO AND APP_USER_TYPE_ID = 9)
       AND NOT EXISTS
              (SELECT 1
                 FROM APP_USER C
                WHERE C.NIC = A.CNIC_NO AND APP_USER_TYPE_ID <> 9);