
  CREATE OR REPLACE FORCE VIEW "I8_MICROBANK_JS_DEV"."VC_FILE_REPORT_VIEW" ("DEVICE_NUMBER", "WALLET_NUMBER", "MOBILE_NUMBER", "TDATE", "LOAD", "PURCHASES", "RBAL") AS 
  select
    device_number,
    wallet_number,
    mobile_number,
    trunc(settlement_date) as TDate,
    sum(case when transaction_code = 'LC' then billing_amount else 0 end) as Load,
    sum(case when transaction_code = '01' then billing_amount else 0 end) as purchases,
    sum(run_bal) as rbal
from
    vc_file
where
    mobile_number <> 0
group by
    device_number,
    wallet_number,
    mobile_number,
    trunc(settlement_date)
order by 
    1,2,3,4;
