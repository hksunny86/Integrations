<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
	     xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	     xmlns:tx="http://www.springframework.org/schema/tx"
	     xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-2.0.xsd
           http://www.springframework.org/schema/aop http://www.springframework.org/schema/aop/spring-aop-2.0.xsd
           http://www.springframework.org/schema/tx http://www.springframework.org/schema/tx/spring-tx-2.0.xsd">


<!-- DAO -->

    <bean id="memberBankDAO" class="com.inov8.microbank.server.dao.bankmodule.hibernate.MemberBankHibernateDAO">
        <property name="sessionFactory" ref="sessionFactory"/>
    </bean>

    <bean id="bankSegmentsDAO" class="com.inov8.microbank.server.dao.bankmodule.hibernate.BankSegmentsHibernateDAO">
        <property name="sessionFactory" ref="sessionFactory"/>
        <property name="dataSource" ref="dataSource" />

    </bean>

  <bean id="bankListViewDAO" class="com.inov8.microbank.server.dao.bankmodule.hibernate.BankListViewHibernateDAO">
    <property name="sessionFactory" ref="sessionFactory"/>
  </bean>
  <bean id="bankUserListViewDAO" class="com.inov8.microbank.server.dao.bankmodule.hibernate.BankUserListViewHibernateDAO">
    <property name="sessionFactory" ref="sessionFactory"/>
  </bean>
  <bean id="bankUserDAO" class="com.inov8.microbank.server.dao.bankmodule.hibernate.BankUserHibernateDAO">
    <property name="sessionFactory" ref="sessionFactory"/>
  </bean>
  <bean id="bankDAO" class="com.inov8.microbank.server.dao.bankmodule.hibernate.BankHibernateDAO">
    <property name="sessionFactory" ref="sessionFactory"/>
  </bean>
  <bean id="appUserDAO" class="com.inov8.microbank.server.dao.securitymodule.hibernate.AppUserHibernateDAO" autowire="byName">
    <property name="sessionFactory" ref="sessionFactory"/>
  </bean>
  
   <bean id="goldenNosDAO" class="com.inov8.microbank.server.dao.portal.mfsaccountmodule.hibernate.GoldenNosHibernateDAO">
    <property name="sessionFactory" ref="sessionFactory"/>
  </bean>

  <bean id="goldenNoSequenceGenerator" class="com.inov8.framework.server.dao.framework.jdbc.OracleSequenceGeneratorJdbcDAO" init-method="initDao">
    <property name="dataSource" ref="dataSource"/>
    <property name="sequenceName" value="GOLDEN_NOS_SEQ"/>
  </bean>
 
  <bean id="concernPartnerDAO" class="com.inov8.microbank.server.dao.portal.concernmodule.hibernate.ConcernPartnerHibernateDAO">
    <property name="sessionFactory" ref="sessionFactory"/>
  </bean>  

  <bean id="partnerDAO" class="com.inov8.microbank.server.dao.usergroupmodule.hibernate.PartnerHibernateDAO">
	   <property name="sessionFactory" ref="sessionFactory"/>
  </bean>  

  <bean id="partnerPermissionGroupDAO" class="com.inov8.microbank.server.dao.usergroupmodule.hibernate.PartnerPermissionGroupHibernateDAO">
	   <property name="sessionFactory" ref="sessionFactory"/>
  </bean>  


<!-- Service -->

  <bean id="bankManager" parent="baseTransactionProxy">
    <property name="target">
      <bean class="com.inov8.microbank.server.service.bankmodule.BankManagerImpl">
        <property name="bankDAO">
          <ref local="bankDAO"/>
        </property>
        <property name="genericDao">
			<ref bean="genericHibernateDAO"/>
		</property>
        <property name="bankListViewDAO">
          <ref local="bankListViewDAO"/>
        </property>
        <property name="concernPartnerDAO">
          <ref local="concernPartnerDAO"/>
        </property> 
       <property name="partnerDAO">
          <ref local="partnerDAO"/>
       </property>
       <property name="partnerPermissionGroupDAO">
          <ref local="partnerPermissionGroupDAO"/>
       </property>
      </bean>
    </property>
  </bean>

  <bean id="bankUserManager" parent="baseTransactionProxy">
		<property name="target">
			<bean class="com.inov8.microbank.server.service.bankmodule.BankUserManagerImpl">
				<property name="appUserPartnerGroupDAO" ref="appUserPartnerGroupDAO"/>
				
				<property name="bankUserDAO">
					<ref local="bankUserDAO"/>
				</property>
				<property name="appUserManager" ref="userManager"/>
				
               <property name="bankUserListViewDAO">
               
               		<ref local="bankUserListViewDAO"/>
               		</property>
               		
               	<property name="goldenNosDAO">
          <ref local="goldenNosDAO"/>
        </property> 	
				<property name="custTransManager" ref="custTransManager"/>
               <property name="sequenceGenerator" ref="goldenNoSequenceGenerator"/>
				
                                <property name="appUserDAO">
                                        <ref bean="appUserDAO"/>
                                        </property>
                                
			</bean>
		</property>
	</bean>

<!-- Facade -->

  <bean id="bankFacade" class="com.inov8.microbank.server.facade.BankFacadeImpl">
    <property name="frameworkExceptionTranslator">
      <ref bean="frameworkExceptionTranslator"/>
    </property>
    <property name="bankManager">
      <ref local="bankManager"/>
    </property>
     <property name="bankUserManager">
      <ref local="bankUserManager"/>
    </property>
  </bean>

</beans>
