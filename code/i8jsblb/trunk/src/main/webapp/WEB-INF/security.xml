<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xmlns:tx="http://www.springframework.org/schema/tx"
       xmlns:util="http://www.springframework.org/schema/util"
       xmlns:security="http://www.springframework.org/schema/security"
       xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-2.0.xsd
           http://www.springframework.org/schema/aop http://www.springframework.org/schema/aop/spring-aop-2.0.xsd
           http://www.springframework.org/schema/tx http://www.springframework.org/schema/tx/spring-tx-2.0.xsd
           http://www.springframework.org/schema/security http://www.springframework.org/schema/security/spring-security-3.1.xsd
           http://www.springframework.org/schema/util http://www.springframework.org/schema/util/spring-util-3.1.xsd">

    <!-- ======================== FILTER CHAIN ======================= -->
    <alias name="filterChainProxy" alias="springSecurityFilterChain"/>

    <bean id="filterChainProxy" class="org.springframework.security.web.FilterChainProxy">
        <constructor-arg>
            <util:list>
                <security:filter-chain pattern="/**/*p_*"
                                       filters="concurrentSessionFilter,xSSCleanFilter,httpSessionContextIntegrationFilter,authenticationProcessingFilter,securityContextHolderAwareRequestFilter,rememberMeProcessingFilter,anonymousProcessingFilter,exceptionTranslationFilter,filterInvocationInterceptor,accessLevelFilter,forceChangePasswordFilter"/>
                <security:filter-chain pattern="/**/*p-*"
                                       filters="concurrentSessionFilter,xSSCleanFilter,httpSessionContextIntegrationFilter,authenticationProcessingFilter,securityContextHolderAwareRequestFilter,rememberMeProcessingFilter,anonymousProcessingFilter,exceptionTranslationFilter,filterInvocationInterceptor,accessLevelFilter,forceChangePasswordFilter"/>
                <security:filter-chain pattern="/**"
                                       filters="concurrentSessionFilter,xSSCleanFilter,httpSessionContextIntegrationFilter,logoutFilter,authenticationProcessingFilter,securityContextHolderAwareRequestFilter,rememberMeProcessingFilter,anonymousProcessingFilter,exceptionTranslationFilter,filterInvocationInterceptor,forceChangePasswordFilter"/>
            </util:list>
        </constructor-arg>
    </bean>

    <bean id="httpSessionContextIntegrationFilter"
          class="org.springframework.security.web.context.SecurityContextPersistenceFilter">
        <property name="securityContextRepository" ref="securityContextRepositoryNoJSession"/>
    </bean>


    <bean id="xSSCleanFilter" class="com.inov8.microbank.webapp.filter.XSSCleanFilter"/>

    <bean id="accessLevelFilter" class="com.inov8.microbank.webapp.filter.AccessLevelAuthorizationFilter">
        <property name="doAllowMissingAction" value="false"/>
    </bean>

    <bean id="securityContextRepositoryNoJSession"
          class="org.springframework.security.web.context.HttpSessionSecurityContextRepository">
        <property name="disableUrlRewriting" value="true"/>
    </bean>


    <bean id="logoutFilter" class="org.springframework.security.web.authentication.logout.LogoutFilter">
        <constructor-arg index="0" value="/login.jsp"/> <!-- URL redirected to after logout -->
        <constructor-arg index="1">
            <list>
                <ref bean="rememberMeServices"/>
                <bean class="org.springframework.security.web.authentication.logout.SecurityContextLogoutHandler"/>
                <!--<bean id="securityContextLogoutHandler"
                   class="org.springframework.security.web.authentication.logout.SecurityContextLogoutHandler" />-->
                <bean id="customLogoutHandler" class="com.inov8.microbank.webapp.action.handler.CustomLogoutHandler"/>
            </list>
        </constructor-arg>
        <property name="filterProcessesUrl" value="/logout.jsp"/>
    </bean>

    <bean id="authenticationProcessingFilter" class="com.inov8.microbank.webapp.filter.CustomAuthenticationFilter">
        <property name="authenticationManager" ref="authenticationManager"/>
        <property name="filterProcessesUrl" value="/j_spring_security_check"/>
        <property name="rememberMeServices" ref="rememberMeServices"/>
        <property name="partnerDAO" ref="partnerDAO"/>
        <property name="partnerIpAddressDAO" ref="partnerIpAddressDAO"/>
        <property name="appUserManager" ref="userManager"/>
        <property name="retailerContactManager" ref="retailerFacade"/>
        <property name="handlerManager" ref="handlerManager"/>
        <property name="allpayRetailerAccountManager" ref="allpayRetailerAccountFacade"/>
        <property name="sessionAuthenticationStrategy" ref="sessionController"/>
        <property name="authenticationSuccessHandler">
            <bean class="org.springframework.security.web.authentication.SavedRequestAwareAuthenticationSuccessHandler">
                <property name="defaultTargetUrl" value="/home.html"/>
            </bean>
        </property>
        <!--<property name="authenticationFailureHandler">
                  <bean class="org.springframework.security.web.authentication.SimpleUrlAuthenticationFailureHandler">
                      <property name="defaultFailureUrl" value="/login.jsp?error=true"/>
                  </bean>
              </property>-->

        <property name="authenticationFailureHandler">
            <bean class="com.inov8.microbank.webapp.action.handler.FailedAuthenticationHandler">
                <property name="defaultFailureUrl" value="/login.jsp?error=true"/>
            </bean>
        </property>
        <property name="accountControlManager" ref="accountControlManager"/>
    </bean>

    <bean id="securityContextHolderAwareRequestFilter"
          class="org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter"/>

    <bean id="rememberMeProcessingFilter"
          class="org.springframework.security.web.authentication.rememberme.RememberMeAuthenticationFilter">
        <property name="authenticationManager" ref="authenticationManager"/>
        <property name="rememberMeServices" ref="rememberMeServices"/>
    </bean>
    <bean id="anonymousProcessingFilter"
          class="org.springframework.security.web.authentication.AnonymousAuthenticationFilter">
        <property name="key" value="anonymous"/>
        <property name="userAttribute" value="anonymous,ROLE_ANONYMOUS"/>
    </bean>

    <bean id="exceptionTranslationFilter" class="org.springframework.security.web.access.ExceptionTranslationFilter">
        <property name="authenticationEntryPoint">
            <bean class="com.inov8.microbank.webapp.action.handler.CustomEntryPoint">
                <property name="loginFormUrl" value="/login.jsp"/>
                <property name="forceHttps" value="false"/>
            </bean>
        </property>
    </bean>

    <bean id="forceChangePasswordFilter" class="com.inov8.microbank.webapp.filter.ForceChangePasswordFilter">
        <property name="appUserManager" ref="securityFacade"/>
    </bean>
    <bean id="customFilterInvocationInterceptor" class="com.inov8.microbank.webapp.filter.CustomFilterInvocationFilter"
          parent="filterInvocationInterceptor">
    </bean>
    <bean id="filterInvocationInterceptor"
          class="org.springframework.security.web.access.intercept.FilterSecurityInterceptor">
        <property name="authenticationManager" ref="authenticationManager"/>
        <property name="accessDecisionManager" ref="accessDecisionManager"/>
        <property name="securityMetadataSource">
            <security:filter-security-metadata-source request-matcher="ant">

                <!--Debit Card Start -->
                <security:intercept-url pattern="/**/updateDebitCardRequests.html*"
                                        access="PG_GP_R,MNG_BB_CARDS_R,MNG_BB_CARDS_U"/>
                <security:intercept-url pattern="/**/schedulersmanagement.html*"
                                        access="PG_GP_R,MNG_BATCH_JOBS_R,MNG_BATCH_JOBS_U"/>
                <security:intercept-url pattern="/**/debitCardSchedulersController.html*"
                                        access="PG_GP_R,MNG_BATCH_JOBS_R,MNG_BATCH_JOBS_U"/>
                <security:intercept-url pattern="/**/debitCardFeeSchedulersController.html*"
                                        access="PG_GP_R,MNG_BATCH_JOBS_R,MNG_BATCH_JOBS_U"/>
                <security:intercept-url pattern="/**/debitCardAnnualFeeSchedulerController.html*"
                                        access="PG_GP_R,MNG_BATCH_JOBS_R,MNG_BATCH_JOBS_U"/>
                <security:intercept-url pattern="/**/acHolderDisbursementSchedulersController.html*"
                                        access="PG_GP_R,MNG_BATCH_JOBS_R,MNG_BATCH_JOBS_U"/>
                <!--Debit Card End -->
                <security:intercept-url pattern="/**/*p-removedormancy.html*"
                                        access="MNG_CUST_ACC_CLOSURE_U,PG_GP_U,ADM_GP_R"/>
                <security:intercept-url pattern="/**/*activatedeactivate.html*"
                                        access="ADM_GP_R,MNG_GEN_ACC_U,MNO_GP_R,PAS_GP_R,PRS_GP_R,CSR_GP_R,RET_GP_R,PG_GP_U,DEACTIVATE_AGNT_U,REACTIVATE_AGNT_U,BLOCK_AGNT_U,UNBLOCK_AGNT_U,DEACTIVATE_BB_CUST_U,REACTIVATE_BB_CUST_U,BLOCK_BB_CUST_U,UNBLOCK_BB_CUST_U,MNG_USR_GRPS_U"/>
                <security:intercept-url pattern="/**/*home.html*"
                                        access="ADM_GP_R,HOME_PAGE_R,MNO_GP_R,PAS_GP_R,PRS_GP_R,CSR_GP_R,RET_GP_R"/>
                <security:intercept-url pattern="/**/*p_activatedeactivatewebserviceform.html*"
                                        access="ADM_GP_R,MNO_GP_R,PAS_GP_R,PRS_GP_R,CSR_GP_R,DEACTIVATE_WEB_SERVICE_BB_CUST_U,ACTIVATE_WEB_SERVICE_BB_CUST_U"/>
                <security:intercept-url pattern="/**/*changepasswordform.html*"
                                        access="ADM_GP_R,CHNGE_PWD_U,MNO_GP_R,PAS_GP_R,PRS_GP_R,CSR_GP_R"/>
                <security:intercept-url pattern="/**/*p_allpayretailerheadreport.html*"
                                        access="ADM_GP_R,RET_GP_R,DIS_GP_R"/>
                <security:intercept-url pattern="/**/*p_allpaybillsummaryreport.html*"
                                        access="ADM_GP_R,RET_GP_R,DIS_GP_R"/>
                <security:intercept-url pattern="/**/*/p_allpayretailerreport.html*" access="ADM_GP_R,RET_GP_R"/>
                <security:intercept-url pattern="/**/*/p_allpaydistributorheadreport.html*" access="DIS_GP_R,ADM_GP_R"/>
                <security:intercept-url pattern="/**/*/p_allpaydistheadsummaryreport.html*" access="DIS_GP_R,ADM_GP_R"/>
                <security:intercept-url pattern="/**/*p_allpayregheadsummaryreport.html*" access="ADM_GP_R,RET_GP_R"/>
                <security:intercept-url pattern="/**/*p_allpayretailersummaryreport.html*" access="ADM_GP_R,RET_GP_R"/>
                <security:intercept-url pattern="/**/*p_manualadjustment.html*" access="PG_GP_C,MANUAL_ADJUSTMENT_C"/>
                <security:intercept-url pattern="/**/*p_manualadjustmentreport.html*"
                                        access="PG_GP_R,RPT_MANUAL_ADJUSTMENT_R"/>
                <security:intercept-url pattern="/**/*p_bulkManualAdjustmentReport.html*"
                                        access="ADM_GP_R,PG_GP_R,RPT_BULK_MANUAL_ADJUSTMENT_R"/>
                <security:intercept-url pattern="/**/p_bulkreversal.html*" access="PG_GP_R,RPT_MANUAL_ADJUSTMENT_R,PG_GP_C"/>
                <security:intercept-url pattern="/**/*p_bulkReversalForm.html*"
                                        access="ADM_GP_R,PG_GP_R,RPT_BULK_MANUAL_ADJUSTMENT_R"/>
                <security:intercept-url pattern="/**/*/p_allpaybillsummaryreport.html*" access="ADM_GP_R"/>
                <security:intercept-url pattern="/**/*p_linkedaccountsreport.html*" access="LNK_ACC_RPT_R"/>
                <security:intercept-url pattern="/**/*bankform.html*" access="ADM_GP_R"/>
                <security:intercept-url pattern="/**/*/creditinfomanagement.html*" access="ADM_GP_R"/>
                <security:intercept-url pattern="/**/*bankmanagement.html*" access="ADM_GP_R"/>
                <security:intercept-url pattern="/**/*commissionrateform.html*"
                                        access="ADM_GP_U,MNG_TX_CHARGES_U,PG_GP_U,ADM_GP_C,MNG_TX_CHARGES_C,PG_GP_C"/>
                <security:intercept-url pattern="/**/*commissionratemanagement.html*"
                                        access="ADM_GP_R,MNG_GEN_ACC_R,LNK_PAY_MOD_R,FRGT_BNK_PIN_R,FRGT_GEN_PIN_R,MNG_TX_CHARGES_R,PG_GP_R"/>
                <security:intercept-url pattern="/**/*allpayforgotpassword.html*"
                                        access="ADM_GP_R,MNG_GEN_ACC_R,LNK_PAY_MOD_R,FRGT_BNK_PIN_R,FRGT_GEN_PIN_R"/>
                <security:intercept-url pattern="/**/*commissionreasonform.html*" access="ADM_GP_R"/>
                <security:intercept-url pattern="/**/*commissionreasonmanagement.html*" access="ADM_GP_R,PG_GP_R"/>
                <security:intercept-url pattern="/**/*smartmoneyaccountform.html*" access="ADM_GP_R"/>
                <security:intercept-url pattern="/**/*smartmoneyaccountmanagement.html*" access="ADM_GP_R"/>
                <security:intercept-url pattern="/**/*productmanagement.html*" access="ADM_GP_R"/>
                <security:intercept-url pattern="/**/*productform.html*" access="ADM_GP_R"/>
                <security:intercept-url pattern="/**/*productcatalogform.html*"
                                        access="ADM_GP_R,ADM_GP_U,PG_GP_C,PG_GP_U,MNG_PRDCT_CAT_R,MNG_PRDCT_CAT_U,MNG_PRDCT_CAT_C"/>
                <security:intercept-url pattern="/**/*productcatalogmanagement.html*"
                                        access="ADM_GP_R,ADM_GP_U,MNG_PRDCT_CAT_R"/>
                <security:intercept-url pattern="/**/*distributorcontactmanagement.html*" access="ADM_GP_R"/>
                <security:intercept-url pattern="/**/*distributorcontactform.html*" access="ADM_GP_R"/>
                <security:intercept-url pattern="/**/*distributormanagement.html*" access="ADM_GP_R"/>
                <security:intercept-url pattern="/**/*distributorform.html*" access="ADM_GP_R"/>
                <security:intercept-url pattern="/**/*distributorlevelmanagement.html*"
                                        access="ADM_GP_R,MNG_GEN_ACC_R,LNK_PAY_MOD_R"/>
                <security:intercept-url pattern="/**/*distributorlevelform.html*"
                                        access="ADM_GP_R,MNG_GEN_ACC_R,LNK_PAY_MOD_R"/>
                <security:intercept-url pattern="/**/*shipmentmanagement.html*" access="ADM_GP_R"/>
                <security:intercept-url pattern="/**/*shipmentform.html*" access="ADM_GP_R"/>
                <security:intercept-url pattern="/**/*uploadentryform.html*" access="ADM_GP_R"/>
                <security:intercept-url pattern="/**/*productunitmanagement.html*" access="ADM_GP_R"/>
                <security:intercept-url pattern="/**/*productunitform.html*" access="ADM_GP_R"/>
                <security:intercept-url pattern="/**/*retailercontactmanagement.html*" access="ADM_GP_R"/>
                <security:intercept-url pattern="/**/*suppliermanagement.html*" access="ADM_GP_R"/>
                <security:intercept-url pattern="/**/*supplierform.html*" access="ADM_GP_R"/>
                <security:intercept-url pattern="/**/*supplierusermanagement.html*" access="ADM_GP_R"/>
                <security:intercept-url pattern="/**/*supplieruserform.html*" access="ADM_GP_R"/>
                <security:intercept-url pattern="/**/*mnousermanagement.html*" access="ADM_GP_R"/>
                <security:intercept-url pattern="/**/*mnomanagement.html*" access="ADM_GP_R"/>
                <security:intercept-url pattern="/**/*mnoform.html*" access="ADM_GP_R"/>
                <security:intercept-url pattern="/**/*mnouserform.html*" access="ADM_GP_R"/>
                <security:intercept-url pattern="/**/*bankusermanagement.html*" access="ADM_GP_R"/>
                <security:intercept-url pattern="/**/*bankuserform.html*" access="ADM_GP_R"/>
                <security:intercept-url pattern="/**/*areaform.html*" access="ADM_GP_C,ADM_GP_U,PG_GP_C,PG_GP_U"/>
                <security:intercept-url pattern="/**/*areamanagement.html*" access="ADM_GP_R,PG_GP_R"/>
                <security:intercept-url pattern="/**/*command.html*" access="ADM_GP_R"/>
                <security:intercept-url pattern="/**/*retailermanagement.html*"
                                        access="ADM_GP_R,PG_GP_R,MNO_GP_R,RPT_FRANCH_BRANCH_R"/>
                <security:intercept-url pattern="/**/*retailerform.html*" access="ADM_GP_C,ADM_GP_U,PG_GP_C"/>
                <security:intercept-url pattern="/**/*favoritenumber.html*" access="ADM_GP_R"/>
                <security:intercept-url pattern="/**/*notificationmessages.html*" access="ADM_GP_R"/>
                <security:intercept-url pattern="/**/*notificationmessageform.html*" access="ADM_GP_R"/>
                <security:intercept-url pattern="/**/mobilehistory.html*" access="ADM_GP_R"/>
                <security:intercept-url pattern="/**/*tickermanagement.html*" access="ADM_GP_R"/>
                <security:intercept-url pattern="/**/*tickerform.html*" access="ADM_GP_R"/>
                <security:intercept-url pattern="/**/*auditlog.html*" access="ADM_GP_R"/>
                <security:intercept-url pattern="/**/*operatorusermanagement.html*" access="ADM_GP_R"/>
                <security:intercept-url pattern="/**/*operatoruserform.html*" access="ADM_GP_R"/>
                <security:intercept-url pattern="/**/*servicemanagement.html*" access="ADM_GP_R"/>
                <security:intercept-url pattern="/**/*serviceform.html*" access="ADM_GP_R"/>
                <security:intercept-url pattern="/**/*devicetypemanagement.html*" access="ADM_GP_R"/>
                <security:intercept-url pattern="/**/*devicetypeform.html*" access="ADM_GP_R"/>
                <security:intercept-url pattern="/**/*goldennosmanagement.html*" access="ADM_GP_R"/>
                <security:intercept-url pattern="/**/*goldennosform.html*" access="ADM_GP_R"/>
                <security:intercept-url pattern="/**/*switchfindermanagement.html*" access="ADM_GP_R"/>
                <security:intercept-url pattern="/**/*switchfinderform.html*" access="ADM_GP_R"/>
                <security:intercept-url pattern="/**/*servicetype.html*" access="ADM_GP_R"/>
                <security:intercept-url pattern="/**/*servicetypeform.html*" access="ADM_GP_R"/>
                <security:intercept-url pattern="/**/*switchmanagement.html*" access="ADM_GP_R"/>
                <security:intercept-url pattern="/**/*switchform.html*" access="ADM_GP_R"/>
                <security:intercept-url pattern="/**/*stakeholderbankform.html*" access="ADM_GP_R"/>
                <security:intercept-url pattern="/**/*stakeholderbankinfomanagement.html*" access="ADM_GP_R"/>
                <security:intercept-url pattern="/**/*supplierbankinfoform.html*" access="ADM_GP_R"/>
                <security:intercept-url pattern="/**/*userdeviceaccount.html*" access="ADM_GP_R"/>
                <security:intercept-url pattern="/**/*userdeviceaccountform.html*" access="ADM_GP_R"/>
                <security:intercept-url pattern="/**/*mnodialingcodeform.html*" access="ADM_GP_R"/>
                <security:intercept-url pattern="/**/*mnodialingcodemanagement.html*" access="ADM_GP_R"/>
                <security:intercept-url pattern="/**/*veriflymanagement.html*" access="ADM_GP_R"/>
                <security:intercept-url pattern="/**/*veriflyform.html*" access="ADM_GP_R"/>
                <security:intercept-url pattern="/**/*commissionstakeholdermanagement.html*" access="ADM_GP_R,PG_GP_R"/>
                <security:intercept-url pattern="/**/*p_commissionshsharesmanagement.html*"
                                        access="ADM_GP_R,PG_GP_R,MNG_COMM_SH_SHARE_R"/>
                <security:intercept-url pattern="/**/*commissionshsharesform.html*"
                                        access="ADM_GP_C,ADM_GP_U,PG_GP_C,PG_GP_U,MNG_COMM_SH_SHARE_U,MNG_COMM_SH_SHARE_C"/>
                <security:intercept-url pattern="/**/*p_customertransactionlimits.html*"
                                        access="ADM_GP_R,PG_GP_R,CUST_TX_LIMITS_R"/>
                <security:intercept-url pattern="/**/*commissionstakeholderform.html*" access="ADM_GP_R"/>
                <security:intercept-url pattern="/**/*applicationversionmanagement.html*" access="ADM_GP_R"/>
                <security:intercept-url pattern="/**/*applicationversionform.html*" access="ADM_GP_R"/>
                <security:intercept-url pattern="/**/*customermanagement.html*" access="ADM_GP_R"/>
                <security:intercept-url pattern="/**/*customerform.html*" access="ADM_GP_R"/>
                <security:intercept-url pattern="/**/*retailertype.html*" access="ADM_GP_R"/>
                <security:intercept-url pattern="/**/*retailertypeform.html*" access="ADM_GP_R"/>
                <security:intercept-url pattern="/**/*appusermanagement.html*" access="ADM_GP_R"/>
                <security:intercept-url pattern="/**/*actionlog.html*" access="ADM_GP_R"/>
                <security:intercept-url pattern="/**/*actionlogdetail.html*"
                                        access="PG_GP_U,ADM_GP_R,CSR_GP_U,DEACTIVATE_AGNT_U,REACTIVATE_AGNT_U,UNBLOCK_AGNT_U,BLOCK_AGNT_U,DEACTIVATE_BB_CUST_U,BLOCK_BB_CUST_U,BLOCK_BB_CUST_U,UNBLOCK_BB_CUST_U"/>
                <security:intercept-url pattern="/**/*lescocollectionmanagement.html*" access="ADM_GP_R"/>
                <security:intercept-url pattern="/**/*p_adhocreports.html*" access="ADM_GP_R"/>
                <security:intercept-url pattern="/**/*p_reportdirectory.html*" access="ADM_GP_R"/>
                <security:intercept-url pattern="/**/*p_createIssueController.html*"
                                        access="MNO_GP_R,PAS_GP_R,PRS_GP_R,CSR_GP_R,PG_GP_R"/>
                <security:intercept-url pattern="/**/*p-issueupdateform.html*"
                                        access="MNG_CHARGBACK_U,MNO_GP_R,MNO_GP_U,PAS_GP_R,PAS_GP_U,PRS_GP_R,PRS_GP_U,CSR_GP_R,CSR_GP_U,RET_GP_R,RET_GP_U,ADM_GP_U,PG_GP_U,REQ_CHARGEBACK_U,VIEW_CHARGEBACKS_RIFC_U,VIEW_CHARGEBACKS_RIFA_U"/>
                <security:intercept-url pattern="/**/*p_resendSms.html*"
                                        access="ADM_GP_U,RSND_SMS_AG_TX_U,MNO_GP_R,MNO_GP_U,PAS_GP_R,PAS_GP_U,PRS_GP_R,PRS_GP_U,CSR_GP_R,CSR_GP_U,RET_GP_R,RET_GP_U,PG_GP_U,REGENERATE_TX_CODE_U,REGENERATE_TX_CODE_R"/>
                <security:intercept-url pattern="/**/*p_resendpaymtcnrequest.html*"
                                        access="ADM_GP_U,RSND_SMS_AG_TX_U,MNO_GP_R,MNO_GP_U,PAS_GP_R,PAS_GP_U,PRS_GP_R,PRS_GP_U,CSR_GP_R,CSR_GP_U,RET_GP_R,RET_GP_U,PG_GP_U,RPT_PMTNC_REQ_U"/>
                <security:intercept-url pattern="/**/*p_refData.html*"
                                        access="ADM_GP_U,MNG_CHARGBACK_U,MNO_GP_R,MNO_GP_U,PAS_GP_R,PAS_GP_U,PAS_GP_R,PAS_GP_U,CSR_GP_R,CSR_GP_U,HOME_PAGE_R"/>
                <security:intercept-url pattern="/**/*p_issuehistorymanagement.html*"
                                        access="MNG_CHARGBACK_R,MNO_GP_R,PAS_GP_R,PRS_GP_R,CSR_GP_R,PG_GP_R"/>
                <security:intercept-url pattern="/**/*p_transactionissuehistorymanagement.html*"
                                        access="ADM_GP_R,TRX_DETAIL_POPUP_R"/>
                <security:intercept-url pattern="/**/*p_showtransactiondetail.html*"
                                        access="MNO_GP_R,PAS_GP_R,PRS_GP_R,CSR_GP_R,ADM_GP_R,PG_GP_R"/>
                <security:intercept-url pattern="/**/p_changemobilenomanagement.html*" access="MNO_GP_R"/>
                <security:intercept-url pattern="/**/p_changemobileform.html*" access="MNO_GP_R"/>
                <security:intercept-url pattern="/**/p_mnoforgotpin.html*" access="MNO_GP_R"/>
                <security:intercept-url pattern="/**/p_mnoforgotpinform.html*" access="MNO_GP_R"/>
                <security:intercept-url pattern="/**/p_mnologsmanagement.html*"
                                        access="ADM_GP_R,PG_GP_R,RPT_USR_ACTION_LOGS_R"/>
                <security:intercept-url pattern="/**/p_blackListedNicsHistory.html*"
                                        access="CSR_GP_R,ADM_GP_R,PG_GP_R,MNO_GP_R,BLCK_NIC_RPT_R"/>
                <security:intercept-url pattern="/**/p_walkInBlackListedNicReport.html*"
                                        access="CSR_GP_R,ADM_GP_R,PG_GP_R,MNO_GP_R,BLCK_WALKIN_NIC_RPT_R"/>
                <security:intercept-url pattern="/**/p_expiredNicReport.html*"
                                        access="CSR_GP_R,ADM_GP_R,PG_GP_R,MNO_GP_R,NIC_EXP_RPT_R"/>
                <security:intercept-url pattern="/**/bopcardissuancereport.html*"
                                        access="MNG_GEN_ACC_R,RET_GP_R,ADM_GP_R,PG_GP_R,MNG_BB_CUST_R"/>

                <security:intercept-url pattern="/**/p_ivrMpinVerificationReport.html*"
                                        access="CSR_GP_R,ADM_GP_R,PG_GP_R,MNO_GP_R,RPT_TX_DETAIL_R"/>
                <security:intercept-url pattern="/**/p_currentDayIvrMpinVerificationReport.html*"
                                        access="PG_GP_C,ADD_IVR_MPIN_VERIFICATION_R,ADD_IVR_MPIN_VERIFICATION_D,ADM_GP_R,CSR_GP_R"/>

                <security:intercept-url pattern="/**/p_IntegratedSystemActivityReport.html*"
                                        access="ADM_GP_R,PG_GP_R,RPT_INTGRT_SYS_LOGS_R"/>
                <security:intercept-url pattern="/**/p_mnosearchmfsuser.html*" access="MNO_GP_R"/>
                <security:intercept-url pattern="/**/p_postedtransactionmanagement.html*"
                                        access="ADM_GP_R,PG_GP_R,RPT_POSTED_TX_R"/>
                <security:intercept-url pattern="/**/p_postedtransactionphoenixmanagement.html*"
                                        access="ADM_GP_R,PG_GP_R,CSR_GP_R,RPT_POSTED_TX_PHX_R"/>
                <security:intercept-url pattern="/**/p_postedtransactionnadra.html*"
                                        access="RPT_POSTED_TX_NADRA_R,ADM_GP_R,PG_GP_R,CSR_GP_R"/>
                <security:intercept-url pattern="/**/p_transactionscommission.html*"
                                        access="ADM_GP_R,PG_GP_R,RPT_COMM_RECON_R"/>
                <security:intercept-url pattern="/**/p_postedtransactiondetail.html*"
                                        access="ADM_GP_R,PG_GP_R,RPT_POSTED_TX_R"/>
                <security:intercept-url pattern="/**/p_myconcerns.html*"
                                        access="MNO_GP_R,MNG_MY_CNCRN_R,QUICK_MY_CNCRN_R,PAS_GP_R,RET_GP_R,CSR_GP_R"/>
                <security:intercept-url pattern="/**/p_listconcerns.html*"
                                        access="MNO_GP_R,MNG_PRT_CNCRN_R,PAS_GP_R,RET_GP_R,CSR_GP_R"/>
                <security:intercept-url pattern="/**/p_createconcernform.html*"
                                        access="MNO_GP_C,MNO_GP_U,MNG_MY_CNCRN_C,PRS_GP_U,PRS_GP_C,PAS_GP_U,PAS_GP_C,RET_GP_C"/>
                <security:intercept-url pattern="/**/p_concerndetailform.html*"
                                        access="MNO_GP_R,MNG_MY_CNCRN_R,PAS_GP_R,RET_GP_R"/>
                <security:intercept-url pattern="/**/p_opconcernsmanagement.html*" access="PG_GP_R,CONCERNS_LIST_R"/>
                <security:intercept-url pattern="/**/p_opconcernsdetail.html*" access="PG_GP_R,CONCERNS_LIST_R"/>
                <security:intercept-url pattern="/**/p_opconcerncatdefmanagement.html*"
                                        access="PG_GP_R,CONCERN_CAT_DEF_R"/>
                <security:intercept-url pattern="/**/p_opconcerncategoryform.html*"
                                        access="PG_GP_C,PG_GP_U,CONCERN_CAT_DEF_C,CONCERN_CAT_DEF_U"/>
                <security:intercept-url pattern="/**/p_opconcernrules.html*" access="PG_GP_R,CONCERN_RULES_R"/>
                <security:intercept-url pattern="/**/p_opconcernrulesform.html*"
                                        access="PG_GP_R,PG_GP_U,CONCERN_RULES_R,CONCERN_RULES_U"/>
                <security:intercept-url pattern="/**/p-viewsalesmanagement.html*"
                                        access="MNO_GP_R,PRS_GP_R,ADM_GP_R,RPT_VIEW_SALES_R"/>
                <security:intercept-url pattern="/**/p_bdekpireport.html*"
                                        access="ADM_GP_R,MNO_GP_R,PG_GP_R,MNG_AGNTS_R"/>
                    <security:intercept-url pattern="/**/p_digidebitcardannualreport.html*"
                                        access="ADM_GP_R,MNO_GP_R,PG_GP_R,MNG_AGNTS_R"/>
                <security:intercept-url pattern="/**/p_digipostedrdvreport.html*"
                                        access="ADM_GP_R,MNO_GP_R,PG_GP_R,MNG_AGNTS_R"/>
                <security:intercept-url pattern="/**/p_debitcardchargesreport.html*"
                                        access="ADM_GP_R,MNO_GP_R,PG_GP_R,MNG_AGNTS_R"/>
                <security:intercept-url pattern="/**/p_handleractivityreport.html*"
                                        access="ADM_GP_R,MNO_GP_R,PG_GP_R,MNG_AGNTS_R"/>
                <security:intercept-url pattern="/**/p_agentparentchildreport.html*"
                                        access="ADM_GP_R,MNO_GP_R,PG_GP_R,MNG_AGNTS_R"/>
                <security:intercept-url pattern="/**/p_dormancyReport.html*"
                                        access="ADM_GP_R,MNO_GP_R,PG_GP_R,MNG_AGNTS_R"/>
                <security:intercept-url pattern="/**/p_accountdormancyreport.html*"
                                        access="ADM_GP_R,MNO_GP_R,PG_GP_R,MNG_AGNTS_R"/>
                <security:intercept-url pattern="/**/p_expiredcnicreport.html*"
                                        access="ADM_GP_R,MNO_GP_R,PG_GP_R,MNG_AGNTS_R"/>
                <security:intercept-url pattern="/**/p_customerdisputeprodmanagement.html*" access="MNO_GP_R,PRS_GP_R"/>
                <security:intercept-url pattern="/**/p_prescalatetoinov8.html*" access="MNO_GP_R,PRS_GP_R"/>
                <security:intercept-url pattern="/**/p-viewpaymentsmanagement.html*" access="MNO_GP_R,PAS_GP_R"/>
                <security:intercept-url pattern="/**/p_customerdisputemanagement.html*" access="MNO_GP_R,PAS_GP_R"/>
                <security:intercept-url pattern="/**/p_psescalatetoinov8.html*" access="MNO_GP_R,PAS_GP_R"/>
                <!-- Added by aali-->
                <security:intercept-url pattern="/**/p_OLAAccountManagement.html*" access="OLA_MNG_ACC_R,PG_GP_R"/>
                <security:intercept-url pattern="/**/p_OLACreateEditAccount.html*"
                                        access="OLA_MNG_ACC_C,OLA_MNG_ACC_U"/>
                <security:intercept-url pattern="/**/p_allpayforgotbankpin.html*"
                                        access="ALLPAY_MNG_ACC_C,ALLPAY_MNG_ACC_U,ALLPAY_MNG_ACC_R,ALLPAY_MNG_ACC_D"/>
                <security:intercept-url pattern="/**/*allpayDistributorAccountForm.html*"
                                        access="ADM_GP_R,LNK_PAY_MOD_R,MNG_GEN_ACC_R"/>
                <security:intercept-url pattern="/**/*allpayDistributorAccountManagement.html*"
                                        access="ADM_GP_R,LNK_PAY_MOD_R,MNG_GEN_ACC_R"/>
                <security:intercept-url pattern="/**/*allpayRetailerAccountForm.html*"
                                        access="LNK_PAY_MOD_R,MNG_GEN_ACC_R,PG_GP_C,PG_GP_U,ADM_GP_C,ADM_GP_U"/>
                <security:intercept-url pattern="/**/*allpayRetailerAccountManagement.html*"
                                        access="ADM_GP_R,LNK_PAY_MOD_R,MNG_GEN_ACC_R,MNO_GP_R,PG_GP_R,RPT_AGENTS_R"/>
                <security:intercept-url pattern="/**/*AllpayCommissionRatesForm.html*" access="ADM_GP_R"/>
                <security:intercept-url pattern="/**/*AllpayCommissionRatesManagement.html*" access="ADM_GP_R"/>
                <!--end addition-->


                <!-- added by tayyab islam -->
                <security:intercept-url pattern="/**/searchAgentGroupReport.html*"
                                        access="ADM_GP_R,PG_GP_R,RPT_AGENT_GRP_DETAIL_R"/>

                <security:intercept-url pattern="/**/p_manualreversal.html*" access="ADM_GP_R,PG_GP_R,TRX_REVERSAL_R"/>

                <security:intercept-url pattern="/**/p_mnomfsaccountdetails.html*"
                                        access="MNG_GEN_ACC_R,CSR_GP_R,ADM_GP_R,PG_GP_R,MNG_L2_CUST_R"/>
                <security:intercept-url pattern="/**/p_mnomfsaccountdetails.html*"
                                        access="MNG_GEN_ACC_R,CSR_GP_R,ADM_GP_R,PG_GP_R,MNG_BB_CUST_R,QUICK_SEARCH_CUST_R"/>
                <security:intercept-url pattern="/**/p-debitblock.html*"
                                        access="MNG_GEN_ACC_R,CSR_GP_R,ADM_GP_R,PG_GP_R,MNG_L2_CUST_R,MNG_BB_CUST_R,QUICK_SEARCH_CUST_R"/>
                <security:intercept-url pattern="/**/viewcustomerbbstatementmanagement.html*"
                                        access="ADM_GP_R,CSR_GP_R,PG_GP_R,CUST_BB_STMT_R"/>
                <security:intercept-url pattern="/**/p_agentbbstatement.html*"
                                        access="ADM_GP_R,CSR_GP_R,PG_GP_R,AGNT_BB_STMT_R"/>
                <security:intercept-url pattern="/**/p-customertransactiondetails.html*"
                                        access="MNG_GEN_ACC_R,CSR_GP_R,ADM_GP_R,PG_GP_R,CUST_TX_HIST_R"/>
                <security:intercept-url pattern="/**/p_mnonewmfsaccountform.html*"
                                        access="MNG_GEN_ACC_U,MNG_GEN_ACC_C,RET_GP_C,RET_GP_U,ADM_GP_C,PG_GP_C,PG_GP_R,MNG_BB_CUST_C,MNG_BB_CUST_U,QUICK_BB_CUST_C"/>
                <security:intercept-url pattern="/**/p_l2accountform.html*"
                                        access="MNG_GEN_ACC_C,RET_GP_C,RET_GP_U,ADM_GP_C,PG_GP_C,PG_GP_R,MNG_L2_CUST_C,MNG_L2_CUST_U,QUICK_BB_CUST_C"/>
                <security:intercept-url pattern="/**/p_l2_applicantformpopup.html*"
                                        access="MNG_GEN_ACC_C,RET_GP_C,RET_GP_U,ADM_GP_C,PG_GP_C,PG_GP_R,MNG_L2_CUST_C,MNG_L2_CUST_U,QUICK_BB_CUST_C"/>
                <security:intercept-url pattern="/**/p_level2accountdetails.html*"
                                        access="ADM_GP_R,MNG_GEN_ACC_R,PG_GP_R,MNG_L2_CUST_R"/>
                <security:intercept-url pattern="/**/p_bulkcustomeraccountsupload.html*"
                                        access="PG_GP_C,ADD_CUST_BULK_C"/>
                <security:intercept-url pattern="/**/p_bulkcustomerspreview.html*" access="PG_GP_C,ADD_CUST_BULK_C"/>
                <security:intercept-url pattern="/**/p_customeraccounttypemanagement.html*"
                                        access="ADM_GP_R,PG_GP_R,MNG_CUST_AC_TP_LMT_R"/>
                <security:intercept-url pattern="/**/p_customeraccounttypeform.html*"
                                        access="ADM_GP_C,ADM_GP_R,ADM_GP_U,PG_GP_C,PG_GP_R,PG_GP_U,MNG_CUST_AC_TP_LMT_C,MNG_CUST_AC_TP_LMT_R,MNG_CUST_AC_TP_LMT_U"/>
                <security:intercept-url pattern="/**/p_bulkdisbursements.html*" access="PG_GP_C,BULK_DISBURSEMENTS_C"/>
                <security:intercept-url pattern="/**/p_disbursementFileInfo.html*" access="PG_GP_R,DISB_F_SUMR_R"/>
                <security:intercept-url pattern="/**/p_bulkdisbursementsearch.html*"
                                        access="PG_GP_R,MNG_BULK_DISBURSEMENTS_R"/>
                <security:intercept-url pattern="/**/p_bulkdisbursementform.html*"
                                        access="PG_GP_U,MNG_BULK_DISBURSEMENTS_U"/>
                <security:intercept-url pattern="/**/p_bulkdisbursementspreview.html*"
                                        access="PG_GP_C,BULK_DISBURSEMENTS_C"/>
                <security:intercept-url pattern="/**/p_bulkpaymentsdetail.html*" access="PG_GP_R,RPT_BULK_PAYMENTS_R"/>
                <security:intercept-url pattern="/**/p_downloadinvalidrecordsfile.html*"
                                        access="PG_GP_C,BULK_DISBURSEMENTS_C"/>
                <security:intercept-url pattern="/**/p_linkpaymentmodeform.html*" access="LNK_PAY_MOD_R"/>
                <security:intercept-url pattern="/**/p_delinkrelinkpaymentmodemanagement.html*" access="LNK_PAY_MOD_R"/>
                <security:intercept-url pattern="/**/p_delinkrelinkpaymentmodechange.html*"
                                        access="PG_GP_U,PG_GP_D,DE_LINK_PAY_MOD_U,RE_LINK_PAY_MOD_U,DELETE_PAY_MOD_D"/>
                <security:intercept-url pattern="/**/p_forgotveriflypinmanagement.html*" access="FRGT_BNK_PIN_R"/>
                <security:intercept-url pattern="/**/p_forgotveriflypinChange.html*"
                                        access="FRGT_BNK_PIN_U,CSR_GP_U,RET_GP_U,PG_GP_U,REGENERATE_AGNT_PIN_U"/>
                <security:intercept-url pattern="/**/p_pinchange.html*"
                                        access="FRGT_BNK_PIN_U,CSR_GP_U,RET_GP_U,PG_GP_U,REGENERATE_AGNT_PIN_U"/>
                <security:intercept-url pattern="/**/p_pgforgotpin.html*" access="FRGT_GEN_PIN_R"/>
                <security:intercept-url pattern="/**/p_pgforgotpinupdate.html*" access="FRGT_GEN_PIN_U"/>
                <security:intercept-url pattern="/**/p_pgsearchuserinfo.html*"
                                        access="MNG_GEN_ACC_R,RET_GP_R,ADM_GP_R,PG_GP_R,MNG_BB_CUST_R"/>
                <security:intercept-url pattern="/**/p_minorsearchuserinfo.html*"
                                        access="MNG_GEN_ACC_R,RET_GP_R,ADM_GP_R,PG_GP_R,MNG_BB_CUST_R"/>

                <security:intercept-url pattern="/**/p_refferalcustomer.html*"
                                        access="MNG_GEN_ACC_R,RET_GP_R,ADM_GP_R,PG_GP_R,MNG_BB_CUST_R"/>

                <security:intercept-url pattern="/**/thirdpartyaccountopeningreport.html*"
                                        access="MNG_GEN_ACC_R,RET_GP_R,ADM_GP_R,PG_GP_R,MNG_BB_CUST_R"/>

                <security:intercept-url pattern="/**/p_l2_kyc_searchform.html*"
                                        access="MNG_GEN_ACC_R,RET_GP_R,ADM_GP_R,PG_GP_R,MNG_L2_KYC_R"/>
                <security:intercept-url pattern="/**/p_l2_kyc_form.html*"
                                        access="MNG_GEN_ACC_U,MNG_GEN_ACC_C,ADM_GP_C,ADM_GP_U,PG_GP_C,PG_GP_U,MNG_L2_KYC_C,MNG_L2_KYC_U"/>

                <security:intercept-url pattern="/**/p_mnonewmfsaccountform_print.html*"
                                        access="MNG_GEN_ACC_R,RET_GP_R,ADM_GP_R,PG_GP_R,BB_CUST_PRINT_FORM_R"/>
                <security:intercept-url pattern="/**/p_mnonewmfsaccountform_printer.html*"
                                        access="MNG_GEN_ACC_R,RET_GP_R,ADM_GP_R,PG_GP_R,BB_CUST_REPRINT_FORM_R"/>
                <security:intercept-url pattern="/**/p_pgdeactivatemfsaccount.html*" access="MNG_GEN_ACC_R"/>
                <security:intercept-url pattern="/**/p_adminuserformajax.html*"
                                        access="CSR_GP_U,PG_GP_U,RESET_AGNT_PASS_U"/>
                <security:intercept-url pattern="/**/p_pgviewpaymentmode.html*" access="LNK_PAY_MOD_R"/>
                <security:intercept-url pattern="/**/p-transactiondetailmanagement.html*" access="TX_RPT_R"/>
                <security:intercept-url pattern="/**/p-chargebackmanagement.html*"
                                        access="PG_GP_R,MNG_CHARGBACK_R,VIEW_CHARGEBACKS_R"/>
                <security:intercept-url pattern="/**/p_esctoinov8management.html*" access="ESC_TO_I8_RPT_R"/>
                <security:intercept-url pattern="/**/p_escalationstatusmanagement.html*" access="CSR_GP_R,PG_GP_R"/>
                <security:intercept-url pattern="/**/p_transactiondetaili8management.html*"
                                        access="CSR_GP_R,ADM_GP_R,PG_GP_R,MNO_GP_R,RPT_TX_DETAIL_R"/>
                <security:intercept-url pattern="/**/p_bookmetransactiondetailmanagement.html*"
                                        access="CSR_GP_R,ADM_GP_R,PG_GP_R,MNO_GP_R,RPT_TX_DETAIL_R"/>
                <security:intercept-url pattern="/**/p_agentsegmentrestriction.html*"
                                        access="CSR_GP_R,ADM_GP_R,PG_GP_R,MNO_GP_R,RPT_TX_DETAIL_R"/>
                <security:intercept-url pattern="/**/p_agentsegmentactivedeactive.html*"
                                        access="CSR_GP_R,ADM_GP_R,PG_GP_R,MNO_GP_R,RPT_TX_DETAIL_R"/>
                <security:intercept-url pattern="/**/p_bookmereports.html*"
                                        access="CSR_GP_R,ADM_GP_R,PG_GP_R,MNO_GP_R,RPT_TX_DETAIL_R"/>
                <security:intercept-url pattern="/**/p_clsscreeningreports.html*"
                                        access="CSR_GP_R,ADM_GP_R,PG_GP_R,MNO_GP_R,RPT_TX_DETAIL_R"/>
                <security:intercept-url pattern="/**/p_vcfile.html*"
                                        access="CSR_GP_R,ADM_GP_R,PG_GP_R,MNO_GP_R,RPT_TX_DETAIL_R"/>
                <security:intercept-url pattern="/**/p_vcfileSummary.html*"
                                        access="CSR_GP_R,ADM_GP_R,PG_GP_R,MNO_GP_R,RPT_TX_DETAIL_R"/>
                <security:intercept-url pattern="/**/p_merchantcampaing.html*"
                                        access="CSR_GP_R,ADM_GP_R,PG_GP_R,MNO_GP_R,RPT_TX_DETAIL_R"/>

                <security:intercept-url pattern="/**/p_walletaccountopeningtrackingreports.html*"
                                        access="CSR_GP_R,ADM_GP_R,PG_GP_R,MNO_GP_R,RPT_TX_DETAIL_R"/>
                <security:intercept-url pattern="/**/p_clsscreeningrejectedaccountopeningreports.html*"
                                        access="CSR_GP_R,ADM_GP_R,PG_GP_R,MNO_GP_R,RPT_TX_DETAIL_R"/>
                <security:intercept-url pattern="/**/p_transactiondetaili8management.html*"
                                        access="CSR_GP_R,ADM_GP_R,PG_GP_R,MNO_GP_R,RPT_TX_DETAIL_R"/>
                <security:intercept-url pattern="/**/p_bisptransactiondetailreport.html*"
                                        access="CSR_GP_R,ADM_GP_R,PG_GP_R,MNO_GP_R,BISP_RPT_TX_DETAIL_R"/>
                <security:intercept-url pattern="/**/p_alltransactionsmanagement.html*"
                                        access="ADM_GP_R,PG_GP_R,QUICK_SEARCH_TX_R,RPT_VIEW_TX_R,MNO_GP_R,CSR_GP_R"/>
                <security:intercept-url pattern="/**/p_i8usermanagement.html*" access="ADM_GP_R,PG_GP_R,MNG_USRS_R"/>
                <security:intercept-url pattern="/**/p_i8userformtest.html*"
                                        access="CSR_GP_R,ADM_GP_R,PG_GP_C,PG_GP_U,MNG_USRS_C,MNG_USRS_U"/>
                <security:intercept-url pattern="/**/p_i8escalateform.html*" access="CSR_GP_R,PG_GP_R"/>
                <security:intercept-url pattern="/**/p_i8IssueController.html*" access="CSR_GP_R"/>
                <security:intercept-url pattern="/**/p_adminusermanagement.html*" access="ADM_USR_MGMT_R"/>
                <security:intercept-url pattern="/**/p_adminuserform.html*" access="ADM_USR_MGMT_U,ADM_USR_MGMT_C"/>
                <security:intercept-url pattern="/**/p_partnergroupmanagement.html*"
                                        access="ADM_GP_R,PG_GP_R,MNG_USR_GRPS_R"/>
                <security:intercept-url pattern="/**/p_partnergroupform.html*"
                                        access="ADM_GP_U,ADM_GP_C,PG_GP_C,PG_GP_U,MNG_USR_GRPS_C,MNG_USR_GRPS_U,ACTION_AUTH_R,MNG_USECASE_U"/>
                <security:intercept-url pattern="/**/*allpaytransactiondetailinfomanagement.html*"
                                        access="PG_GP_R,MNO_GP_R,ADM_GP_R"/>
                <security:intercept-url pattern="/**/*transactiondetailinfomanagement.html*"
                                        access="PG_GP_R,MNO_GP_R,ADM_GP_R"/>
                <security:intercept-url pattern="/**/*commissionstakeholderaccountsmanagement.html*"
                                        access="ADM_GP_R,PG_GP_R,MNG_COMM_SH_ACC_R"/>
                <security:intercept-url pattern="/**/*commissionstakeholderaccountsform.html*"
                                        access="ADM_GP_C,ADM_GP_U,PG_GP_C,PG_GP_U,MNG_COMM_SH_ACC_C,MNG_COMM_SH_ACC_U"/>
                <security:intercept-url pattern="/**/*productdeviceflowmanagement.html*" access="ADM_GP_R"/>

                <security:intercept-url pattern="/**/*p_handleraccountdetails.html*"
                                        access="ADM_GP_R,CSR_GP_R,MNO_GP_R,PG_GP_R,MNG_AGNTS_R,QUICK_SEARCH_AGNT_R"/>
                <security:intercept-url pattern="/**/*allpayRetailerAccountDetails.html*"
                                        access="ADM_GP_R,CSR_GP_R,MNO_GP_R,PG_GP_R,MNG_AGNTS_R,QUICK_SEARCH_AGNT_R"/>
                <security:intercept-url pattern="/**/*allpayagenttransactiondetails.html*"
                                        access="ADM_GP_R,CSR_GP_R,MNO_GP_R,RET_GP_R,PG_GP_R,AGNT_TX_HIST_R,QUICK_AGNT_TX_HIST_R"/>
                <security:intercept-url pattern="/**/*p_customerchargebacklist.html*"
                                        access="CSR_GP_R,MNO_GP_R,ADM_GP_R,RET_GP_R,PG_GP_R,REQ_CHARGEBACK_R"/>
                <security:intercept-url pattern="/**/*p_cashwithdrawaltransdetails.html*"
                                        access="REGENERATE_TX_CODE_U,REGENERATE_TX_CODE_R"/>
                <security:intercept-url pattern="/**/*p_cashtransferreversals.html*"
                                        access="RPT_CTR_R,ADM_GP_R,PG_GP_R"/>
                <security:intercept-url pattern="/**/*p_transactionreversalform.html*"
                                        access="ADM_GP_U,PG_GP_R,RPT_CTR_REVERSE_U,SENDER_REDEEM_U,SENDER_REDEEM_R"/>
                <security:intercept-url pattern="/**/*p_transactionreversaldetail.html*"
                                        access="ADM_GP_R,PG_GP_R,RPT_CTR_REVERSE_R"/>
                <security:intercept-url pattern="/**/p_alertsrecepientssearch.html*"
                                        access="PG_GP_R,MNG_ALERT_RECIPIENT_R"/>
                <security:intercept-url pattern="/**/p_alertsrecepientsform.html*"
                                        access="PG_GP_U,PG_GP_C,MNG_ALERT_RECIPIENT_U,MNG_ALERT_RECIPIENT_C"/>
                <security:intercept-url pattern="/**/p_alertconfigsearch.html*" access="PG_GP_R,MNG_ALERT_CONFIG_R"/>
                <security:intercept-url pattern="/**/p_alertconfigform.html*" access="PG_GP_U,MNG_ALERT_CONFIG_U"/>
                <security:intercept-url pattern="/**/p_mobilehistory.html*" access="PG_GP_U,UPDATE_CUSTOMER_MOBILE_U"/>
                <security:intercept-url pattern="/**/p_cnichistory.html*" access="PG_GP_U,UPDATE_CUSTOMER_MOBILE_U"/>

                <!-- Marketing reports -->
                <security:intercept-url pattern="/**/*p_p2ptransactiondetail.html*"
                                        access="MNO_GP_R,ADM_GP_R,PG_GP_R,RPT_P2P_TRANSFER_R"/>
                <security:intercept-url pattern="/**/*p_marketingdatewiseactivity.html*"
                                        access="MNO_GP_R,ADM_GP_R,PG_GP_R,RPT_DATE_WISE_ACT_R"/>
                <security:intercept-url pattern="/**/*p_marketingtransactiontypesummary.html*"
                                        access="MNO_GP_R,ADM_GP_R,PG_GP_R,RPT_TX_TYPE_SUMM_R"/>
                <security:intercept-url pattern="/**/*p_marketingdatewisesummary.html*"
                                        access="MNO_GP_R,ADM_GP_R,PG_GP_R,RPT_DATE_WISE_SUMM_R"/>
                <security:intercept-url pattern="/**/*p_marketingaccountopening.html*"
                                        access="MNO_GP_R,ADM_GP_R,PG_GP_R,RPT_ACT_OPENING_R"/>
                <security:intercept-url pattern="/**/*p_marketingaccounttoaccount.html*"
                                        access="MNO_GP_R,ADM_GP_R,PG_GP_R,RPT_ACT_TO_ACT_R"/>
                <security:intercept-url pattern="/**/*p_marketingaccounttocnic.html*"
                                        access="MNO_GP_R,ADM_GP_R,PG_GP_R,RPT_ACT_TO_CNIC_R"/>
                <security:intercept-url pattern="/**/*p_marketingcnictocnic.html*"
                                        access="MNO_GP_R,ADM_GP_R,PG_GP_R,RPT_CNIC_TO_CNIC_R"/>
                <security:intercept-url pattern="/**/*p_marketingcustomerretailpayment.html*"
                                        access="MNO_GP_R,ADM_GP_R,PG_GP_R,RPT_CUST_RETAIL_PAY_R"/>
                <security:intercept-url pattern="/**/*p_marketingbalancetopup.html*"
                                        access="MNO_GP_R,ADM_GP_R,PG_GP_R,RPT_BAL_TOP_UP_R"/>
                <security:intercept-url pattern="/**/*p_marketingcashdeposit.html*"
                                        access="MNO_GP_R,ADM_GP_R,PG_GP_R,RPT_CASH_DEP_R"/>
                <security:intercept-url pattern="/**/*p_marketingcashwithdrawal.html*"
                                        access="MNO_GP_R,ADM_GP_R,PG_GP_R,RPT_CASH_WITHDRAWAL_R"/>
                <security:intercept-url pattern="/**/*p_marketingtransactionalrevenue.html*"
                                        access="MNO_GP_R,ADM_GP_R,PG_GP_R,RPT_TX_REVENUE_R"/>
                <security:intercept-url pattern="/**/*p_marketingbillpayment.html*"
                                        access="MNO_GP_R,ADM_GP_R,PG_GP_R,RPT_UTIL_BILL_PAY_R"/>
                <!-- Marketing Retail Franchise reports-->
                <security:intercept-url pattern="/**/*p_marketingfranchiseactivity.html*"
                                        access="MNO_GP_R,ADM_GP_R,PG_GP_R,RPT_FRANCH_ACTIVITY_R"/>
                <security:intercept-url pattern="/**/*p_marketingretailactivity.html*"
                                        access="MNO_GP_R,ADM_GP_R,PG_GP_R,RPT_RETAIL_ACTIVITY_R"/>
                <security:intercept-url pattern="/**/*p_marketingregionalactivity.html*"
                                        access="MNO_GP_R,ADM_GP_R,PG_GP_R,RPT_REG_RETAIL_ACTIVITY_R"/>
                <!-- Finance reports -->
                <security:intercept-url pattern="/**/*p_financeagentclosingbalance.html*"
                                        access="MNO_GP_R,ADM_GP_R,PG_GP_R,RPT_AGNT_CLOSING_BAL_R"/>
                <security:intercept-url pattern="/**/*p_financecustomerbalance.html*"
                                        access="MNO_GP_R,ADM_GP_R,PG_GP_R,RPT_CUST_CLOSING_BAL_R"/>
                <security:intercept-url pattern="/**/*p_financecommissionsummary.html*"
                                        access="MNO_GP_R,ADM_GP_R,PG_GP_R,RPT_TOTAL_COMM_SUMM_R"/>
                <security:intercept-url pattern="/**/*p_settlementbbaccounts.html*"
                                        access="MNO_GP_R,ADM_GP_R,PG_GP_R,RPT_BB_ACT_R"/>
                <security:intercept-url pattern="/**/*p_settlementbbstatement.html*"
                                        access="MNO_GP_R,ADM_GP_R,PG_GP_R,RPT_SETTLEMENT_BB_STMT_R"/>
                <security:intercept-url pattern="/**/p_ofsettlementtransaction.html*"
                                        access="ADM_GP_R,PG_GP_R,MNO_GP_R,RPT_OF_SETTLEMENT_SUMM_R"/>
                <security:intercept-url pattern="/**/p_ofsettlementtransactiondetail.html*"
                                        access="ADM_GP_R,PG_GP_R,MNO_GP_R,RPT_OF_SETTLEMENT_DETAIL_R"/>
                <!-- added by atif hussain -->
                <security:intercept-url pattern="/**/*p_financesettlementclosingbalance.html*"
                                        access="MNO_GP_R,ADM_GP_R,PG_GP_R,RPT_SETTLEMENT_CLOSING_BAL_R"/>
                <!-- FED/WHT reports -->
                <security:intercept-url pattern="/**/*p_whtagentreport.html*"
                                        access="MNO_GP_R,ADM_GP_R,PG_GP_R,RPT_AGENT_WHT_R"/>
                <security:intercept-url pattern="/**/*p_whtAgentCustReport231A.html*"
                                        access="MNO_GP_R,ADM_GP_R,PG_GP_R,RPT_AGENT_WHT_231_A_R"/>
                <security:intercept-url pattern="/**/*p_whtAgentCustReport236P.html*"
                                        access="MNO_GP_R,ADM_GP_R,PG_GP_R,RPT_AGENT_WHT_236_P_R"/>
                <security:intercept-url pattern="/**/*p_feddetailedreport.html*"
                                        access="MNO_GP_R,ADM_GP_R,PG_GP_R,RPT_FED_DETAILED_R"/>
                <security:intercept-url pattern="/**/*p_whtdetailedreport.html*"
                                        access="MNO_GP_R,ADM_GP_R,PG_GP_R,RPT_WHT_DETAILED_R"/>
                <security:intercept-url pattern="/**/*p_fedbreakupdetailreport.html*"
                                        access="MNO_GP_R,ADM_GP_R,PG_GP_R,RPT_FED_DET_R"/>
                <security:intercept-url pattern="/**/*p_cashtransactionreport.html*"
                                        access="MNO_GP_R,ADM_GP_R,PG_GP_R,RPT_CASH_TRX_R"/>
                <security:intercept-url pattern="/**/*p_targetedwhtdetailreport.html*"
                                        access="MNO_GP_R,ADM_GP_R,PG_GP_R,TRG_WHT_DET_RPT_R"/>

                <!-- Agent Reports -->
                <security:intercept-url pattern="/**/*p_handlertransactiondetail.html*"
                                        access="MNO_GP_R,ADM_GP_R,PG_GP_R,RPT_HANDLER_TX_DETAIL_R"/>
                <security:intercept-url pattern="/**/*p_agenttransactionsummary.html*"
                                        access="MNO_GP_R,ADM_GP_R,PG_GP_R,RPT_AGENT_TX_SUMMARY_R"/>
                <security:intercept-url pattern="/**/*p_agenttransactiondetail.html*"
                                        access="MNO_GP_R,ADM_GP_R,PG_GP_R,RPT_AGNT_DETAILED_TX_R"/>
                <security:intercept-url pattern="/**/*p_bbaccountsbyagents.html*"
                                        access="MNO_GP_R,ADM_GP_R,PG_GP_R,RPT_AGNT_AC_SUMM_R"/>
                <security:intercept-url pattern="/**/*p_salesteamcomission.html*"
                                        access="ADM_GP_R,PG_GP_R,MNO_GP_R,RPT_SALES_TEAM_COMM_R"/>
                <security:intercept-url pattern="/**/*p_complaintsubcategorysearch.html*"
                                        access="PG_GP_R,MNG_COMPLAINT_NATURE_R"/>
                <security:intercept-url pattern="/**/searchDebitCardRequests.html*" access="PG_GP_R,MNG_BB_CARDS_R"/>
                <security:intercept-url pattern="/**/debitcardmanagement.html*" access="PG_GP_R,MNG_BB_CARDS_R"/>
                <security:intercept-url pattern="/**/cardfeeconfiguration.html*"
                                        access="PG_GP_R,MNG_CARDS_FEE_R,MNG_CARDS_FEE_C,MNG_CARDS_FEE_U,MNG_CARDS_FEE_D"/>
                <security:intercept-url pattern="/**/p_debitcardannualfeeinstallments.html*"
                                        access="PG_GP_R,MNG_CARDS_FEE_R,MNG_CARDS_FEE_C,MNG_CARDS_FEE_U,MNG_CARDS_FEE_D"/>
                <security:intercept-url pattern="/**/*p_complaintsubcategoryform.html*"
                                        access="PG_GP_C,PG_GP_U,MNG_COMPLAINT_NATURE_C,MNG_COMPLAINT_NATURE_U"/>
                <security:intercept-url pattern="/**/*p_cashmovementreport.html*"
                                        access="MNO_GP_R,ADM_GP_R,PG_GP_R,RPT_CASH_BANK_RECON_R"/>
                <security:intercept-url pattern="/**/*p_agentcashupload.html*"
                                        access="MNO_GP_R,ADM_GP_R,PG_GP_R,RPT_CASH_BANK_RECON_UPLOAD_R"/>
                <security:intercept-url pattern="/**/*p_complaintform.html*"
                                        access="CSR_GP_C,CSR_GP_U,ADD_COMPLAINT_C"/>
                <security:intercept-url pattern="/**/*p_listcomplaint.html*"
                                        access="CSR_GP_R,MNO_GP_R,PG_GP_R,LIST_COMPLAINTS_R"/>
                <security:intercept-url pattern="/**/*p_mycomplaints.html*" access="CSR_GP_R,PG_GP_R,MY_COMPLAINTS_R"/>
                <security:intercept-url pattern="/**/*p_complaintDetailForm.html*"
                                        access="CSR_GP_R,MNO_GP_R,PG_GP_R,MY_COMPLAINTS_R,LIST_COMPLAINTS_R"/>
                <security:intercept-url pattern="/**/*p_billpaycomplaints.html*" access="CSR_GP_R,QUICK_SEARCH_COMP_R"/>
                <security:intercept-url pattern="/**/p_dayendsettlementreport.html*"
                                        access="ADM_GP_R,PG_GP_R,RPT_DAY_END_SETTLEMENT_R"/>
                <!-- <security:intercept-url pattern="/**/dayEndSettlementDownload.html*" access="ADM_GP_R,PG_GP_R,RPT_DAY_END_SETTLEMENT_R"/>-->

                <!-- Misc reports -->
                <security:intercept-url pattern="/**/*p_walkincustomers.html*"
                                        access="ADM_GP_R,PG_GP_R,RPT_SRCH_WALK_IN_R"/>
                <security:intercept-url pattern="/**/*p_feddetailedreport.html*"
                                        access="ADM_GP_R,PG_GP_R,RPT_SRCH_WALK_IN_R"/>
                <security:intercept-url pattern="/**/*p_walkincustomerltransactiondetails.html*"
                                        access="ADM_GP_R,PG_GP_R,RPT_SRCH_WALK_IN_TX_HIST_R"/>
                <security:intercept-url pattern="/**/*p_bbcustomeraccounts.html*"
                                        access="ADM_GP_R,PG_GP_R,RPT_BB_ACCOUNTS_R"/>
                <security:intercept-url pattern="/**/*p_digiDormancyAccounts.html*"
                                        access="ADM_GP_R,PG_GP_R,RPT_BB_ACCOUNTS_R"/>
                <security:intercept-url pattern="/**/*p_bulkfranchisereport.html*"
                                        access="ADM_GP_R,PG_GP_R,RPT_BULK_FRANCH_R"/>
                <security:intercept-url pattern="/**/p_exportzipdownload.html*"
                                        access="ADM_GP_R,PG_GP_R,CSR_GP_R,MNO_GP_R,RPT_EXPORT_ZIP_R"/>
                <security:intercept-url pattern="/**/*p_bulkagentreport.html*"
                                        access="ADM_GP_R,PG_GP_R,RPT_BULK_AGNT_R"/>
                <security:intercept-url pattern="/clickstreams.jsp*" access="ADM_GP_R"/>
                <security:intercept-url pattern="/logout.jsp"
                                        access="ROLE_ANONYMOUS,ADM_GP_R,MNO_GP_R,PAS_GP_R,PRS_GP_R,CSR_GP_R"/>
                <security:intercept-url pattern="/**/*searchDistributors.jsf*"
                                        access="ADM_GP_R,MNO_GP_R,PG_GP_R,MNG_AGNT_NET_R"/>
                <security:intercept-url pattern="/**/*addDistributor.jsf*"
                                        access="ADM_GP_C,ADM_GP_R,ADM_GP_U,MNO_GP_R,PG_GP_C,PG_GP_R,PG_GP_U,MNG_AGNT_NET_C,MNG_AGNT_NET_R,MNG_AGNT_NET_U"/>
                <security:intercept-url pattern="/**/*addRegionalHierarchy.jsf*"
                                        access="ADM_GP_C,ADM_GP_U,PG_GP_C,PG_GP_U,MNG_REG_HIER_C,MNG_REG_HIER_U"/>
                <security:intercept-url pattern="/**/*associateRegionalHierarchy.jsf*"
                                        access="ADM_GP_C,ADM_GP_U,PG_GP_C,PG_GP_U,MNG_REG_HIER_C,MNG_REG_HIER_U"/>
                <security:intercept-url pattern="/**/*searchRegionalHierarchy.jsf*"
                                        access="ADM_GP_C,ADM_GP_U,PG_GP_C,PG_GP_U,MNG_REG_HIER_R"/>
                <security:intercept-url pattern="/**/*createSalesHierarchy.jsf*"
                                        access="ADM_GP_C,ADM_GP_U,PG_GP_C,PG_GP_U,MNG_SALES_HIER_C"/>
                <security:intercept-url pattern="/**/*viewSalesHierarchy.jsf*"
                                        access="ADM_GP_C,ADM_GP_U,PG_GP_C,PG_GP_U,MNG_SALES_HIER_R"/>
                <security:intercept-url pattern="/**/*searchFranchise.jsf*"
                                        access="ADM_GP_R,MNO_GP_R,PG_GP_R,MNG_FRANCH_R"/>
                <security:intercept-url pattern="/**/*addFranchise.jsf*"
                                        access="ADM_GP_C,ADM_GP_R,ADM_GP_U,MNO_GP_R,PG_GP_C,PG_GP_R,PG_GP_U,MNG_FRANCH_C,MNG_FRANCH_R,MNG_FRANCH_U"/>
                <security:intercept-url pattern="/**/*addFranchiseBulk.jsf*"
                                        access="ADM_GP_C,PG_GP_C,ADD_FRANCH_BULK_C"/>
                <security:intercept-url pattern="/**/*addAgentBulk.jsf*"
                                        access="MNO_GP_R,MNO_GP_C,ADM_GP_R,PG_GP_R,MNG_BULK_AGENT_C"/>
                <security:intercept-url pattern="/**/bulkcustomersegmenttagging.jsf*"
                                        access="MNG_GEN_ACC_R,RET_GP_R,ADM_GP_R,PG_GP_R,CUST_BULK_SEG_TAG_R,CUST_BULK_SEG_TAG_U"/>
                <security:intercept-url pattern="/**/p_allpaylinkpaymentmode.html*"
                                        access="ADM_GP_C,PG_GP_C,LINK_PAY_MOD_C"/>
                <security:intercept-url pattern="/**/p_allpayderelinkpaymentmode.html*"
                                        access="ADM_GP_R,PG_GP_R,RPT_DE_RE_LINK_PAY_R"/>
                <security:intercept-url pattern="/**/p_l3accountsmanagement.html*"
                                        access="ADM_GP_R,PG_GP_R,MNG_L3_ACT_R,MNG_L3_AMDF_R,MNG_L3_KYC_R"/>
                <security:intercept-url pattern="/**/p_agentmerchantdetailsform.html*"
                                        access="ADM_GP_C,PG_GP_C,MNG_L3_AMDF_R,MNG_L3_AMDF_C,MNG_L3_AMDF_U,MNG_L3_ACT_R,MNG_L3_ACT_C,MNG_L3_ACT_U,MNG_L3_KYC_R,MNG_L3_KYC_C,MNG_L3_KYC_U"/>
                <security:intercept-url pattern="/**/p_agentmerchantmanagement.html*"
                                        access="ADM_GP_R,PG_GP_R,MNG_L3_AMDF_R,MNG_L3_ACT_R,MNG_L3_KYC_R"/>
                <security:intercept-url pattern="/**/p_l3_kyc_form.html*"
                                        access="ADM_GP_C,PG_GP_C,MNG_L3_KYC_R,MNG_L3_KYC_C,MNG_L3_KYC_U,MNG_L3_ACT_R,MNG_L3_ACT_C,MNG_L3_ACT_U"/>
                <security:intercept-url pattern="/**/p_l3accountopeningform.html*"
                                        access="ADM_GP_C,PG_GP_C,MNG_L3_ACT_C,MNG_L3_ACT_U,MNG_L3_ACT_R"/>
                <security:intercept-url pattern="/**/p_l3_applicantformpopup.jsp*"
                                        access="ADM_GP_C,PG_GP_C,MNG_L3_ACT_C,MNG_L3_ACT_U"/>
                <security:intercept-url pattern="/**/*searchAgent.jsf*" access="ADM_GP_R,MNO_GP_R,PG_GP_R,MNG_AGNTS_R"/>
                <security:intercept-url pattern="/**/*addAgent.jsf*"
                                        access="ADM_GP_R,ADM_GP_U,MNO_GP_R,PG_GP_R,PG_GP_U,MNG_AGNTS_R,MNG_AGNTS_U"/>
                <security:intercept-url pattern="/**/*p_addhandler.jsf*"
                                        access="ADM_GP_R,ADM_GP_U,MNO_GP_R,PG_GP_R,PG_GP_U,MNG_HNDLR_R,MNG_HNDLR_U"/>
                <security:intercept-url pattern="/**/*p_cashInAccountHolder.jsf*"
                                        access="ADM_GP_R,ADM_GP_U,MNO_GP_R,PG_GP_R,PG_GP_U,MNG_HNDLR_R,MNG_HNDLR_U"/>
                <security:intercept-url pattern="/**/*p_cashInWalkinCustomer.jsf*"
                                        access="ADM_GP_R,ADM_GP_U,MNO_GP_R,PG_GP_R,PG_GP_U,MNG_HNDLR_R,MNG_HNDLR_U"/>
                <security:intercept-url pattern="/**/*p_cashInTellerSummery.jsf*"
                                        access="ADM_GP_R,MNO_GP_R,PG_GP_R,MNG_AGNTS_R"/>

                <security:intercept-url pattern="/**/*addRegion.jsf*"
                                        access="ADM_GP_C,ADM_GP_R,ADM_GP_U,MNO_GP_R,PG_GP_C,PG_GP_R,PG_GP_U,MNG_AGNT_NET_C,MNG_AGNT_NET_R,MNG_AGNT_NET_U"/>
                <security:intercept-url pattern="/**/*addAreaLevel.jsf*"
                                        access="ADM_GP_C,ADM_GP_R,ADM_GP_U,MNO_GP_R,PG_GP_C,PG_GP_R,PG_GP_U,MNG_REG_HIER_C,MNG_REG_HIER_R,MNG_REG_HIER_U"/>
                <security:intercept-url pattern="/**/*addAgentLevel.jsf*"
                                        access="ADM_GP_C,ADM_GP_R,ADM_GP_U,MNO_GP_R,PG_GP_C,PG_GP_R,PG_GP_U,MNG_REG_HIER_C,MNG_REG_HIER_R,MNG_REG_HIER_U"/>
                <security:intercept-url pattern="/**/*addAreaName.jsf*"
                                        access="ADM_GP_C,ADM_GP_R,ADM_GP_U,MNO_GP_R,PG_GP_C,PG_GP_R,PG_GP_U,MNG_REG_HIER_C,MNG_REG_HIER_R,MNG_REG_HIER_U"/>
                <security:intercept-url pattern="/**/*agentHierarchy.jsf*"
                                        access="ADM_GP_R,MNO_GP_R,PG_GP_R,AGNT_HRCHY_R"/>
                <security:intercept-url pattern="/**/*areaNameHierarchy.faces*"
                                        access="ADM_GP_C,ADM_GP_R,ADM_GP_U,MNO_GP_R,PG_GP_C,PG_GP_R,PG_GP_U,MNG_AGNTS_C,MNG_AGNTS_R,MNG_AGNTS_U"/>

                <!-- Product management-Payment Gateway -->
                <security:intercept-url pattern="/**/*productsearch.html*"
                                        access="MNG_PRDCT_LMTS_R,PG_GP_R,ADM_GP_R,MNO_GP_R"/>
                <!-- <security:intercept-url pattern="/**/*productupdateform.html*" access="MNG_PRDCT_LMTS_U,PG_GP_U,ADM_GP_U"/> -->
                <security:intercept-url pattern="/**/*productupdateform.html*"
                                        access="MNG_PRDCT_LMTS_U,MNG_PRDCT_LMTS_C,PG_GP_U,PG_GP_C,ADM_GP_U,ADM_GP_C"/>
                <security:intercept-url pattern="/**/*p_productcustomizeshare.html*" access="MNG_PRDCT_LMTS_U,PG_GP_U,ADM_GP_U,MNO_GP_R,MNG_PRDCT_LMTS_C,PG_GP_C,
		ADM_GP_C,MNO_GP_C,MNO_GP_U,MNG_PRDCT_SHRS_D,MNG_PRDCT_SHRS_U,MNG_PRDCT_SHRS_R"/>
                <!-- added by atif hussain -->
                <security:intercept-url pattern="/**/*productlimitsruleform.html*" access="MNG_PRDCT_LMTS_U,PG_GP_U,ADM_GP_U,MNO_GP_R,MNG_PRDCT_LMTS_C,PG_GP_C,ADM_GP_C,MNO_GP_C,MNO_GP_U,
		MNG_PRDCT_LMT_R,MNG_PRDCT_LMT_U"/>
                <security:intercept-url pattern="/**/*p_productchargesruleform.html*" access="MNG_PRDCT_LMTS_U,PG_GP_U,ADM_GP_U,MNO_GP_R,MNG_PRDCT_LMTS_C,
		PG_GP_C,ADM_GP_C,MNO_GP_C,MNO_GP_U,MNG_PRDCT_CHRGS_R,MNG_PRDCT_CHRGS_U,MNG_PRDCT_CHRGS_D"/>
                <security:intercept-url pattern="/**/productthresholdcharges.html*" access="MNG_PRDCT_LMTS_U,PG_GP_U,ADM_GP_U,MNO_GP_R,MNG_PRDCT_LMTS_C,
		PG_GP_C,ADM_GP_C,MNO_GP_C,MNO_GP_U,MNG_PRDCT_CHRGS_R,MNG_PRDCT_CHRGS_U,MNG_PRDCT_CHRGS_D"/>
                <security:intercept-url pattern="/**/*p_retryadvicelistviewmanagement.html*"
                                        access="ADM_GP_R,RPT_RETRY_ADVICE_R,RPT_RETRY_ADVICE_U"/>
                <security:intercept-url pattern="/**/*p_retryadviceajaxrequest.html*"
                                        access="ADM_GP_R,RPT_RETRY_ADVICE_R,RPT_RETRY_ADVICE_U"/>
                <security:intercept-url pattern="/**/*p_retryadvicesearchhistory.html*"
                                        access="ADM_GP_R,RPT_RETRY_ADVICE_R,RPT_RETRY_ADVICE_U"/>
                <security:intercept-url pattern="/**/*p_retryCreditAccount.html*"
                                        access="ADM_GP_R,RETRY_CREDIT_R,RETRY_CREDIT_U"/>
                <security:intercept-url pattern="/**/*p_agenttransferruleform.html*"
                                        access="ADM_GP_R,PG_GP_R,MNG_TRNSFR_RULE_U"/>
                <security:intercept-url pattern="/**/*p_createAgentGroup.html*"
                                        access="ADM_GP_R,PG_GP_R,AGENT_GRP_C,AGENT_GRP_U"/>
                <security:intercept-url pattern="/**/*p_searchAgentGroup.html*"
                                        access="ADM_GP_R,PG_GP_R,AGENT_GRP_R,AGENT_GRP_U"/>
                <security:intercept-url pattern="/**/*p_unsettledcommreport.html*"
                                        access="ADM_GP_R,PG_GP_R,RPT_UNSTLD_COM_R"/>

                <!-- , RPT_TX_ADVICE_R -->


                <security:intercept-url pattern="/**/*p_ibftretryadvicelist.html*"
                                        access="ADM_GP_R,IBFT_RETRY_ADVICE_R,IBFT_RETRY_ADVICE_U"/>
                <security:intercept-url pattern="/**/*p-ibftretryadvicehistory.html*"
                                        access="ADM_GP_R,IBFT_RETRY_ADVICE_R,IBFT_RETRY_ADVICE_U"/>
                <security:intercept-url pattern="/**/*p_ibftretryadviceajaxrequest.html*"
                                        access="ADM_GP_R,IBFT_RETRY_ADVICE_R,IBFT_RETRY_ADVICE_U"/>
                <security:intercept-url pattern="/**/*p_approvedDebitCardRequests.html*"
                                        access="ADM_GP_U,PG_GP_U,ACTION_AUTH_R,MNG_USECASE_U"/>
                <!-- Customer Segment management-Payment Gateway -->
                <security:intercept-url pattern="/**/*p_customersegmentmanagement.html*"
                                        access="MNG_CUST_SGMNT_R,PG_GP_R,ADM_GP_R"/>
                <security:intercept-url pattern="/**/*p_customersegmentform.html*"
                                        access="MNG_CUST_SGMNT_U,MNG_CUST_SGMNT_C,PG_GP_U,PG_GP_C,ADM_GP_C,ADM_GP_U"/>

                <!-- Customer Account Closure management-Payment Gateway -->
                <security:intercept-url pattern="/**/*p-accountclosingupdateform.html*"
                                        access="MNG_CUST_ACC_CLOSURE_U,PG_GP_U,ADM_GP_R"/>

                <!-- Mark Account As Saving Gateway -->
                <security:intercept-url pattern="/**/*p-markaccountassaving.html*"
                                        access="MNG_ACC_SVNG_U,PG_GP_U,ADM_GP_R"/>

                <!-- Agent Account Closure management-Payment Gateway -->
                <security:intercept-url pattern="/**/*p-retaileraccountclosingform.html*"
                                        access="MNG_AGENT_ACC_CLOSURE_U,PG_GP_U,ADM_GP_R"/>
                <security:intercept-url pattern="/**/*p_collectionpaymenttransactions.html*"
                                        access="PRS_GP_R,RPT_COLL_PAY_R,QUICK_SEARCH_COLL_P_R"/>
                <!-- Reset Transaction Code -Payment Gateway -->
                <security:intercept-url pattern="/**/*p_resettransactioncode.html*"
                                        access="RESET_TX_CODE_U,PG_GP_U,ADM_GP_R"/>
                <security:intercept-url pattern="/**/*p_transactioncodehistory.html*"
                                        access="TX_CODE_HISTORY_R,ADM_GP_R,PG_GP_R"/>
                <!-- Usecase Management  -->
                <security:intercept-url pattern="/**/*p_usecasemanagement.html*"
                                        access="ADM_GP_R,PG_GP_R,MNG_USECASE_R"/>
                <security:intercept-url pattern="/**/*p_usecasemanagementform.html*"
                                        access="ADM_GP_U,PG_GP_U,MNG_USECASE_U"/>
                <security:intercept-url pattern="/p_virtualcards.html*"
                                        access="ADM_GP_R,PG_GP_R,SERCH_VIRTUAL_CARD_R,SERCH_VIRTUAL_CARD_U"/>


                <!-- Authorization -->
                <security:intercept-url pattern="/**/*displayactionlogxml.html*"
                                        access="PG_GP_U,ADM_GP_R,CSR_GP_U,DEACTIVATE_AGNT_U,REACTIVATE_AGNT_U,UNBLOCK_AGNT_U,BLOCK_AGNT_U,DEACTIVATE_BB_CUST_U,BLOCK_BB_CUST_U,BLOCK_BB_CUST_U,UNBLOCK_BB_CUST_U"/>
                <security:intercept-url pattern="/**/*p_actionauthorizationrequests.html*"
                                        access="ADM_GP_R,PG_GP_R,ACTION_AUTH_R"/>
                <security:intercept-url pattern="/**/*p_updateCustomerNameAauthorization.html*"
                                        access="ADM_GP_R,PG_GP_R,ACTION_AUTH_R"/>
                <security:intercept-url pattern="/**/*p_myauthorizationrequests.html*"
                                        access="ADM_GP_R,PG_GP_R,MY_ACTION_AUTH_R"/>
                <security:intercept-url pattern="/**/*p_conflictedauthorizationrequests.html*"
                                        access="ADM_GP_U,PG_GP_U,MNG_USECASE_U"/>
                <security:intercept-url pattern="/**/*p_resettransactioncodeauthorizationDetail.html*"
                                        access="ADM_GP_U,PG_GP_U,MNG_USECASE_U"/>
                <security:intercept-url pattern="/**/*p-resetportalpasswordform.html*"
                                        access="PG_GP_U,ADM_GP_R,RESET_AGNT_PASS_U,MNG_USRS_U"/>
                <security:intercept-url pattern="/**/*p-resetportalpasswordauthorizationdetail.html*"
                                        access="ADM_GP_U,PG_GP_U,ACTION_AUTH_R,MNG_USECASE_U"/>
                <security:intercept-url pattern="/**/*p-resendsmsform.html*"
                                        access="ADM_GP_U,PG_GP_U,CSR_GP_U,RET_GP_U,RESEND_SMS_U"/>
                <security:intercept-url pattern="/**/*p-resendsmsauthorizationdetail.html*"
                                        access="ADM_GP_U,PG_GP_U,ACTION_AUTH_R,MNG_USECASE_U"/>
                <security:intercept-url pattern="/**/*p-lockunlockaccountform.html*"
                                        access="PG_GP_U,ADM_GP_R,CSR_GP_U,DEACTIVATE_AGNT_U,REACTIVATE_AGNT_U,UNBLOCK_AGNT_U,BLOCK_AGNT_U,DEACTIVATE_BB_CUST_U,BLOCK_BB_CUST_U,BLOCK_BB_CUST_U,UNBLOCK_BB_CUST_U"/>
                <security:intercept-url pattern="/**/*p-lockunlockaccountauthorizationdetail.html*"
                                        access="ADM_GP_U,PG_GP_U,ACTION_AUTH_R,MNG_USECASE_U"/>
                <security:intercept-url pattern="/**/*p-allpayredelinkpaymentmodeform.html*"
                                        access="PG_GP_U,ADM_GP_R,CSR_GP_U,DELETE_PAY_MOD_D,DE_LINK_PAY_MOD_U,RE_LINK_PAY_MOD_U"/>
                <security:intercept-url pattern="/**/*p-allpaypaymentmodeauthorizationdetail.html*"
                                        access="ADM_GP_U,PG_GP_U,ACTION_AUTH_R,MNG_USECASE_U"/>
                <security:intercept-url pattern="/**/*p_excludelimitform.html*"
                                        access="ADM_GP_U,PG_GP_U,MNG_EXCLD_LIMIT_RULES_C,MNG_EXCLD_LIMIT_RULES_U"/>
                <security:intercept-url pattern="/**/*p_limitrulemanagement.html*"
                                        access="ADM_GP_U,PG_GP_U,MNG_EXCLD_LIMIT_RULES_R"/>
                <security:intercept-url pattern="/**/*p_velocityruleform.html*"
                                        access="ADM_GP_U,PG_GP_U,MNG_VELOCITY_RULES_U,MNG_VELOCITY_RULES_C"/>
                <security:intercept-url pattern="/**/*p_velocityrulemanagement.html*"
                                        access="ADM_GP_U,PG_GP_U,MNG_VELOCITY_RULES_R"/>

                <security:intercept-url pattern="/**/p_bulkPaymentDisbReport.html*" access="PG_GP_R,DISB_DET_R"/>

                <security:intercept-url pattern="/**/*p-createfranchiseauthorizationdetailform.html*"
                                        access="ADM_GP_U,PG_GP_U,ACTION_AUTH_R,MNG_USECASE_U"/>
                <security:intercept-url pattern="/**/*p-updatefranchiseauthorizationdetailform.html*"
                                        access="ADM_GP_U,PG_GP_U,ACTION_AUTH_R,MNG_USECASE_U"/>
                <security:intercept-url pattern="/**/*p-createcustomerauthorizationdetail.html*"
                                        access="ADM_GP_U,PG_GP_U,ACTION_AUTH_R,MNG_USECASE_U"/>
                <security:intercept-url pattern="/**/*p-createl2accountauthorizationdetail.html*"
                                        access="ADM_GP_U,PG_GP_U,ACTION_AUTH_R,MNG_USECASE_U"/>
                <security:intercept-url pattern="/**/*p-createl3accountauthorizationdetail.html*"
                                        access="ADM_GP_U,PG_GP_U,ACTION_AUTH_R,MNG_USECASE_U"/>
                <security:intercept-url pattern="/**/*p-updatel2accountauthorizationdetail.html*"
                                        access="ADM_GP_U,PG_GP_U,ACTION_AUTH_R,MNG_USECASE_U"/>
                <security:intercept-url pattern="/**/*p-updateaccounttoblink.html*"
                                        access="ADM_GP_U,PG_GP_U,ACTION_AUTH_R,MNG_USECASE_U"/>
                <security:intercept-url pattern="/**/*p-updatel3accountauthorizationdetail.html*"
                                        access="ADM_GP_U,PG_GP_U,ACTION_AUTH_R,MNG_USECASE_U"/>
                <security:intercept-url pattern="/**/*p-updatedebitcardrequestauthorizationdetail.html*"
                                        access="ADM_GP_U,PG_GP_U,ACTION_AUTH_R,MNG_USECASE_U"/>
                <security:intercept-url pattern="/**/p-updatedebitcardauthorizationdetail.html*"
                                        access="ADM_GP_U,PG_GP_U,ACTION_AUTH_R,MNG_USECASE_U"/>
                <security:intercept-url pattern="/**/*p-updateuserauthorizationdetailform.html*"
                                        access="ADM_GP_U,PG_GP_U,ACTION_AUTH_R,MNG_USECASE_U"/>
                <security:intercept-url pattern="/**/*p-usergroupauthorizationdetail.html*"
                                        access="ADM_GP_U,PG_GP_U,ACTION_AUTH_R,MNG_USECASE_U"/>
                <security:intercept-url pattern="/**/*p-updatemobileauthorizationdetail.html*"
                                        access="ADM_GP_U,PG_GP_U,ACTION_AUTH_R,MNG_USECASE_U"/>
                <security:intercept-url pattern="/**/*p-updatecnicauthorizationdetail.html*"
                                        access="ADM_GP_U,PG_GP_U,ACTION_AUTH_R,MNG_USECASE_U"/>
                <security:intercept-url pattern="/**/*p_distributorcommshare.html*"
                                        access="ADM_GP_U,PG_GP_U,AGNT_NET_COMM_SHARE_U"/>
                <security:intercept-url pattern="/**/*p_stakeholderaccounts.html*"
                                        access="ADM_GP_U,PG_GP_U,MNG_SH_ACC_R"/>
                <security:intercept-url pattern="/**/*p-resetuserportalpasswordauthorizationdetail.html*"
                                        access="ADM_GP_U,PG_GP_U,ACTION_AUTH_R,MNG_USECASE_U"/>
                <security:intercept-url pattern="/**/*p-updateusecaseauthorizationdetail.html*"
                                        access="ADM_GP_U,PG_GP_U,ACTION_AUTH_R,MNG_USECASE_U"/>
                <security:intercept-url pattern="/**/*p-updatep2ptxauthorizationdetail.html*"
                                        access="ADM_GP_U,PG_GP_U,ACTION_AUTH_R,MNG_USECASE_U"/>
                <security:intercept-url pattern="/**/*p_updatep2ptxreport.html*"
                                        access="ADM_GP_R,PG_GP_R,UPDATE_P2P_DETAILS_R"/>
                <security:intercept-url pattern="/**/*p_updatep2ptx.html*"
                                        access="ADM_GP_U,PG_GP_U,UPDATE_P2P_DETAILS_U"/>
                <security:intercept-url pattern="/**/*p_sender_redeem.html*"
                                        access="ADM_GP_U,PG_GP_U,SENDER_REDEEM_U,SENDER_REDEEM_R"/>
                <security:intercept-url pattern="/**/*p_transaction_redeem.html*"
                                        access="ADM_GP_R,PG_GP_R,TRANSACTION_REDEEM_U,TRANSACTION_REDEEM_R"/>
                <security:intercept-url pattern="/**/*p_transactionwisewhtreport.html*"
                                        access="MNO_GP_R,ADM_GP_R,PG_GP_R,RPT_TRN_WHT_R"/>
                <security:intercept-url pattern="/**/*p_whtReportStakeholderWise.html*"
                                        access="MNO_GP_R,ADM_GP_R,PG_GP_R,WHT_STHOLDER_R"/>
                <security:intercept-url pattern="/**/*p_searchSenderRedeemTransactionDetail.html*"
                                        access="ADM_GP_R,PG_GP_R,RPT_SENDER_REDMP_DETAIL_R"/>
                <security:intercept-url pattern="/**/*p_searchpaymtcnrequests.html*"
                                        access="ADM_GP_R,PG_GP_R,RPT_PMTNC_REQ_R,RPT_PMTNC_REQ_U"/>
                <security:intercept-url pattern="/**/*p_bulkmanualadjustment.html*" access="PG_GP_C,BULK_MAN_ADJUST_C"/>

                <!-- Tax Management -->
                <security:intercept-url pattern="/**/*p_WHTConfig.html*"
                                        access="ADM_GP_R,PG_GP_R,WHT_CNFG_U,WHT_CNFG_R"/>
                <security:intercept-url pattern="/**/p_fedrulemanagementform.html*"
                                        access="ADM_GP_R,PG_GP_R,MNG_FED_RULE_U,MNG_FED_RULE_R"/>
                <security:intercept-url pattern="/**/p_taxregimedefaultfedrate.html*"
                                        access="ADM_GP_R,PG_GP_R,MNG_TAX_REGIME_R,MNG_TAX_REGIME_C,MNG_TAX_REGIME_U"/>
                <security:intercept-url pattern="/**/*p_WHTTrx.html*" access="ADM_GP_R,PG_GP_R,SERCH_WHT_TRX_R"/>
                <security:intercept-url pattern="/**/*p_searchWHTExemption.html*"
                                        access="ADM_GP_R,PG_GP_R,SERCH_WHT_EXEMP_R"/>
                <security:intercept-url pattern="/**/*p_WHTExemption_form.html*"
                                        access="ADM_GP_R,PG_GP_R,MNG_WHT_EXEM_C,MNG_WHT_EXEM_U"/>


                <security:intercept-url pattern="/**/p_verisysdata.html*"
                                        access="ADM_GP_R,PG_GP_R,MNG_BB_CUST_C,MNG_BB_CUST_R"/>


                <security:intercept-url pattern="/p_virtualcards.html*"
                                        access="ADM_GP_R,PG_GP_R,MNG_WHT_EXEM_C,MNG_WHT_EXEM_U"/>


                <security:intercept-url pattern="/**/*p_blacklistmarking.html*"
                                        access="ADM_GP_R,PG_GP_R,MNG_BLKLST_MRKNG_C,MNG_BLKLST_MRKNG_U,MNG_BLKLST_MRKNG_R"/>
                <security:intercept-url pattern="/**/*p_blacklistmarkingbulkupload.html*"
                                        access="ADM_GP_R,PG_GP_R,MNG_BLKLST_MRKNG_BULK_UPLOAD_C,MNG_BLKLST_MRKNG_BULK_UPLOAD_U,MNG_BLKLST_MRKNG_BULK_UPLOAD_R"/>
                <security:intercept-url pattern="/**/*p_blacklistedCNIC.html*"
                                        access="ADM_GP_R,PG_GP_R,MNG_BLKLST_CNIC_C,MNG_BLKLST_CNIC_U,MNG_BLKLST_CNIC_R"/>

                <security:intercept-url pattern="/**/*p_customeracnaturemarkingbulkupload.html*"
                                        access="ADM_GP_R,PG_GP_R,MNG_BLKLST_MRKNG_BULK_UPLOAD_C,MNG_BLKLST_MRKNG_BULK_UPLOAD_U,MNG_BLKLST_MRKNG_BULK_UPLOAD_R"/>

                <security:intercept-url pattern="/**/conversionRate.html*"
                                        access="PG_GP_R,MNG_BATCH_JOBS_R,MNG_BATCH_JOBS_U"/>
                <security:intercept-url pattern="/**/addTopUpRates.html*"
                                        access="PG_GP_R,MNG_BATCH_JOBS_R,MNG_BATCH_JOBS_U"/>


                <security:intercept-url pattern="/**/*p_IntegratedSystemActivityReport*"
                                        access="ADM_GP_R,PG_GP_R,RPT_INTGRT_SYS_LOGS_R"/>

                <security:intercept-url pattern="/**/*p_fonePayTransactionDetail*"
                                        access="ADM_GP_R,PG_GP_R,SERCH_FP_TRX_RPT_R"/>
                <security:intercept-url pattern="/**/*p-updatecustomerscreening.html*"
                                        access="ADM_GP_R,PG_GP_R,SCR_PER_UPLD_U"/>
                <security:intercept-url pattern="/**/*p_bulkupdatefilernonfiler.html*"
                                        access="ADM_GP_R,PG_GP_R,FILER_NONFILER_UPLD_U"/>


                <security:intercept-url pattern="/*.html" access="HOME_PAGE_R"/>
                <security:intercept-url pattern="/*.jsf" access="HOME_PAGE_R"/>
                <security:intercept-url pattern="/*.xhtml" access="HOME_PAGE_R"/>
            </security:filter-security-metadata-source>
        </property>
    </bean>
    <bean id="accessDecisionManager" class="org.springframework.security.access.vote.AffirmativeBased">
        <property name="allowIfAllAbstainDecisions" value="false"/>
        <property name="decisionVoters">
            <list>
                <bean class="org.springframework.security.access.vote.RoleVoter">
                    <property name="rolePrefix" value=""/>
                </bean>
            </list>
        </property>
    </bean>
    <bean id="rememberMeServices" class="com.inov8.microbank.webapp.action.security.CustomTokenBasedRememberMeServices">
        <property name="userDetailsService" ref="userDao"/>
        <property name="key" value="appfuseRocks"/>
        <property name="parameter" value="rememberMe"/>
    </bean>
    <bean id="authenticationManager" class="org.springframework.security.authentication.ProviderManager">
        <property name="providers">
            <list>
                <ref local="daoAuthenticationProvider"/>
                <ref local="anonymousAuthenticationProvider"/>
                <ref local="rememberMeAuthenticationProvider"/>
            </list>
        </property>
    </bean>
    <bean id="daoAuthenticationProvider"
          class="org.springframework.security.authentication.dao.DaoAuthenticationProvider">
        <property name="userDetailsService" ref="userDao"/>
        <!-- 	<property name="userCache" ref="userCache"/>    -->
        <property name="passwordEncoder" ref="passwordEncoder"/>
        <property name="hideUserNotFoundExceptions" value="false"/>
    </bean>
    <bean id="anonymousAuthenticationProvider"
          class="org.springframework.security.authentication.AnonymousAuthenticationProvider">
        <property name="key" value="anonymous"/>
    </bean>
    <bean id="rememberMeAuthenticationProvider"
          class="org.springframework.security.authentication.RememberMeAuthenticationProvider">
        <property name="key" value="appfuseRocks"/>
    </bean>
    <!--
      This bean definition must be available to ApplicationContext.getBean() so StartupListener
      can look for it and detect if password encryption is turned on or not
    -->
    <bean id="passwordEncoder" class="org.springframework.security.authentication.encoding.ShaPasswordEncoder"/>
    <!-- This bean is optional; it isn't used by any other bean as it only listens and logs -->
    <bean id="loggerListener" class="org.springframework.security.authentication.event.LoggerListener"/>
    <!-- Override 'userManager' bean definition to add userManagerSecurity interceptor -->
    <bean id="userManager" parent="baseTransactionProxy">
        <property name="target">
            <bean class="com.inov8.microbank.server.service.securitymodule.AppUserManagerImpl">
                <property name="mobileNetworkDAO" ref="mobileNetworkDAO"/>
                <property name="appUserDAO" ref="userDao"/>
                <property name="appUserFormListViewDao" ref="appUserFormListViewDao"/>
                <property name="actionLogManager" ref="actionLogManager"/>
                <property name="appUserMobileHistoryDAO" ref="appUserMobileHistoryDAO"/>
                <property name="smsSenderService" ref="smsSenderService"/>
                <property name="customerDAO" ref="customerDAO"/>
                <property name="appUserHistoryViewDao" ref="appUserHistoryViewDao"/>
                <property name="retailerContactDAO" ref="retailerContactDAO"/>
                <property name="accountHolderDAO" ref="accountHolderDAO"/>
                <property name="applicantDetailDAO" ref="applicantDetailDAO"/>
                <property name="accountInfoDao" ref="accountInfoDao"/>
                <property name="ivrRequestHandler" ref="ivrRequestHandler"/>
                <!-- <property name="transactionDetailMasterDAO" ref="transactionDetailMasterDAO"/>
                    <property name="walkinCustomerDAO" ref="walkinCustomerDAO"/> -->
                <property name="complaintReportDAO" ref="complaintReportDAO"/>
                <property name="messageSource" ref="messageSource"/>
                <property name="debitCardModelDAO" ref="debitCardModelDAO"/>
            </bean>
        </property>
        <!-- Override default transaction attributes b/c of UserExistsException -->
        <property name="transactionAttributes">
            <props merge="true">
                <prop key="save*">PROPAGATION_REQUIRED,-UserExistsException</prop>
            </props>
        </property>
        <property name="preInterceptors">
            <list>
                <!--         <ref bean="userSecurityInterceptor"/> -->
                <ref bean="userManagerSecurity"/>
            </list>
        </property>
    </bean>
    <bean id="userManagerSecurity"
          class="org.springframework.security.access.intercept.aopalliance.MethodSecurityInterceptor">
        <property name="authenticationManager" ref="authenticationManager"/>
        <property name="accessDecisionManager" ref="accessDecisionManager"/>
        <property name="securityMetadataSource">
            <security:method-security-metadata-source>
                <security:protect access="ADM_GP_R"
                                  method="com.inov8.microbank.server.service.securitymodule.AppUserManager.getUsers"/>
                <security:protect access="ADM_GP_U"
                                  method="com.inov8.microbank.server.service.securitymodule.AppUserManager.removeUser"/>
            </security:method-security-metadata-source>
        </property>
    </bean>
    <!-- SSL Switching: to use this, configure it in the filterChainProxy bean -->
    <bean id="concurrentSessionFilter" class="com.inov8.microbank.webapp.filter.CustomConcurrentSessionFilter">
        <property name="expiredUrl" value="/login.jsp?logoutReason=concurrentlogin"/>
        <property name="sessionRegistry" ref="sessionRegistry"/>
    </bean>

    <bean id="sessionRegistry" class="org.springframework.security.core.session.SessionRegistryImpl"/>

    <bean id="sessionController"
          class="org.springframework.security.web.authentication.session.ConcurrentSessionControlStrategy">
        <constructor-arg>
            <ref local="sessionRegistry"/>
        </constructor-arg>
        <property name="exceptionIfMaximumExceeded" value="false"/>
        <property name="maximumSessions" value="1"/>
    </bean>


    <bean id="channelProcessingFilter" class="org.springframework.security.web.access.channel.ChannelProcessingFilter">
        <property name="channelDecisionManager" ref="channelDecisionManager"/>
        <property name="securityMetadataSource">
            <security:filter-security-metadata-source request-matcher="ant">
                <security:intercept-url pattern="/admin/**" access="REQUIRES_SECURE_CHANNEL"/>
                <security:intercept-url pattern="/login*" access="REQUIRES_SECURE_CHANNEL"/>
                <security:intercept-url pattern="/j_spring_security_check*" access="REQUIRES_SECURE_CHANNEL"/>
                <security:intercept-url pattern="/editProfile.html*" access="REQUIRES_SECURE_CHANNEL"/>
                <security:intercept-url pattern="/signup.html*" access="REQUIRES_SECURE_CHANNEL"/>
                <security:intercept-url pattern="/saveUser.html*" access="REQUIRES_SECURE_CHANNEL"/>
                <security:intercept-url pattern="/**" access="REQUIRES_INSECURE_CHANNEL"/>
            </security:filter-security-metadata-source>
        </property>
    </bean>
    <bean id="channelDecisionManager"
          class="org.springframework.security.web.access.channel.ChannelDecisionManagerImpl">
        <property name="channelProcessors">
            <list>
                <bean class="org.springframework.security.web.access.channel.SecureChannelProcessor"/>
                <bean class="org.springframework.security.web.access.channel.InsecureChannelProcessor"/>
            </list>
        </property>
    </bean>

    <bean class="com.inov8.microbank.webapp.listener.ApplicationSecurityListener"/>
</beans>
